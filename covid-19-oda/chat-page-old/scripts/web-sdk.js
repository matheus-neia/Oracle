/*!
 * Copyright (c) 2020 Oracle and/or its affiliates.
 *  All rights reserved. Oracle Digital Assistant Chat Web SDK, Release: 20.3.1
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WebSDK=e():t.WebSDK=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var o=(r=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),s=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[n].concat(s).concat([o]).join("\n")}var r,a,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(i)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(o[r]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);i&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),o={LEFT:"left",RIGHT:"right"};e.MESSAGE_SIDE=o;var s=function(){function t(t,e,n,o,s,r){if(this.utils=t,this.settings=e,this.side=o,this.markAsRead=r,this.actions=[],this.globalActions=[],this._options={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.date=s,n.actions)for(var a=0,c=0,l=n.actions;c<l.length;c++){a++,(g=l[c]).actionId="action"+a;var h=i.ActionComponentFactory.fromActionPayload(t,g);h&&(h.onActionClick=this.handleOnActionClick.bind(this),this.actions.push(h))}if(n.globalActions)for(var u=0,p=0,d=n.globalActions;p<d.length;p++){var g;u++,(g=d[p]).actionId="globalAction"+u;var f=i.ActionComponentFactory.fromActionPayload(t,g);f&&(f.onActionClick=this.handleOnActionClick.bind(this),this.globalActions.push(f))}this.headerText=n.headerText,this.footerText=n.footerText}return t.prototype.handleOnActionClick=function(t){if(this.onActionClick){var e=t;e.messageComponent=this,this.onActionClick(e)}},t.prototype.handleOnActionTrigger=function(t){var e=+t.match(/\d+/g)[0];return"action"===t.match(/[a-zA-Z]+/g)[0]?this.actions.length>=e?this.actions[e-1]:null:this.globalActions.length>=e?this.globalActions[e-1]:null},t.prototype.render=function(t){return this._renderMessage(t,this.actions,this.globalActions)},t.prototype.updateMarkAsRead=function(){return this.renderMsgReadStatus(!0),this.markAsRead(this.date)},t.prototype.appendActions=function(t,e){if(e.length>0){for(var n=this.utils.createDiv(["message-actions"]),i=0,o=e;i<o.length;i++){var s=o[i];n.appendChild(s.render())}t.appendChild(n)}},t.prototype.appendGlobalActions=function(t,e){if(e.length>0){for(var n=this.utils.createDiv(["message-global-actions"]),i=0,o=e;i<o.length;i++){var s=o[i];n.appendChild(s.render())}t.appendChild(n)}},t.prototype.getContent=function(){throw new Error("Method not implemented.")},t.prototype.disableActions=function(t){if("postback"!==this.settings.disablePastActions||t){for(var e=0,n=this.actions;e<n.length;e++){(l=n[e]).disable()}for(var i=0,o=this.globalActions;i<o.length;i++){(l=o[i]).disable()}}else{for(var s=0,r=this.actions;s<r.length;s++){"postback"!==(l=r[s]).getActionType()&&"location"!==l.getActionType()||l.disable()}for(var a=0,c=this.globalActions;a<c.length;a++){var l;"postback"!==(l=c[a]).getActionType()&&"location"!==l.getActionType()||l.disable()}}},t.prototype.enableActions=function(){for(var t=0,e=this.actions;t<e.length;t++){e[t].enable()}for(var n=0,i=this.globalActions;n<i.length;n++){i[n].enable()}},t.prototype.renderMsgReadStatus=function(t){if(this._chatDate){var e=this.date?new Date(this.date):new Date,n=t?this.settings.readMark:"";this._chatDate.innerHTML=e.toLocaleTimeString(this.settings.locale,this._options)+n}},t.prototype._renderMessage=function(t,e,n){var i=this.utils.createDiv(["message",this.side]);i.style.color=this.settings.colors.text;var s=["message-wrapper"];n&&n.length>0&&s.push("has-global-actions"),this._messageWrapper=this.utils.createDiv(s),i.appendChild(this._messageWrapper);var r=this.side===o.LEFT?this.settings.botIcon:this.settings.personIcon;if(r){var a=this.utils.createDiv(["icon-wrapper"]);a.appendChild(this.utils.createImage(r,["message-icon"])),this._messageWrapper.appendChild(a)}var c=this.utils.createDiv(["content-wrapper"]),l=this.utils.createDiv(["message-bubble"]);l.style.padding=this.settings.messagePadding||l.style.padding;var h=this.utils.createDiv(["message-content"]);if(h.appendChild(t||this.getContent()),l.appendChild(h),e&&(this.settings.displayActionsAsPills?this.appendGlobalActions(i,e):this.appendActions(l,e)),this.settings.enableTimestamp){this._chatDate=this.utils.createDiv(["chat-message-date"]);var u=this.date?new Date(this.date):new Date;this._chatDate.innerHTML=u.toLocaleTimeString(this.settings.locale,this._options),l.appendChild(this._chatDate)}if(c.appendChild(l),this.headerText&&c.firstElementChild.classList.add(this.utils.getCssClassWithPrefix("has-header")),this.footerText&&c.firstElementChild.classList.add(this.utils.getCssClassWithPrefix("has-footer")),this.headerText){var p=this.utils.createDiv(["message-bubble","message-header"]);p.innerText=this.headerText,c.prepend(p)}if(this.footerText){var d=this.utils.createDiv(["message-bubble","message-footer"]);d.innerText=this.footerText,c.appendChild(d)}return this._messageWrapper.appendChild(c),n&&this.appendGlobalActions(i,n),i},t}();e.MessageComponent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={isDivVisible:function(t,e){var n=t.scrollTop,i=n+t.offsetHeight,o=e.offsetTop,s=o+e.offsetHeight;return o>n&&o<i||s<i&&s>n},isFunction:function(t){return"function"==typeof t},isSvg:function(t){var e=t.match(/<svg\s/gi);return e&&e.length>0},secToMillisec:function(t){return 1e3*t},setSearchParams:function(t,e){if("URLSearchParams"in window){for(var n=t.search,i=new URLSearchParams(n),o=0,s=Object.keys(e);o<s.length;o++){var r=s[o];i.set(r,e[r])}t.search=i.toString()}else{i=[];for(var a=0,c=Object.keys(e);a<c.length;a++){r=c[a];i.push(r+"="+e[r])}i.length&&(t.search="?"+i.join("&"))}return t}};e.utils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.module=t}return t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.DEBUG,e)},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.ERROR,e)},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.INFO,e)},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.WARN,e)},t.prototype._log=function(e,n){if(t.logLevel>=e){n.unshift("["+t.appName+"."+t.appVersion+"."+this.module+"]");var i=void 0;switch(t.logLevel){case t.LOG_LEVEL.ERROR:i=console.error;break;case t.LOG_LEVEL.WARN:i=console.warn;break;case t.LOG_LEVEL.INFO:i=console.info;break;case t.LOG_LEVEL.DEBUG:i=console.debug}t.historyEnabled&&(t.history.push(Object.assign({},n,{level:e})),t._historySize<=t.history.length&&t.history.shift()),i.apply(console,n)}},t.LOG_LEVEL={DEBUG:4,ERROR:1,INFO:3,NONE:0,WARN:2},t.logLevel=t.LOG_LEVEL.ERROR,t.history=[],t.historyEnabled=!1,t._historySize=100,t}();e.Logger=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSING=2]="CLOSING",t[t.CLOSED=3]="CLOSED"}(e.CONNECTION_STATE||(e.CONNECTION_STATE={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.utils=t,this._disabled=!1,this._actionId=e.actionId,this._type=e.type,this._label=e.label,this._imageUrl=e.imageUrl}return t.prototype.render=function(){if(this._htmlElement=this.utils.createAnchor(),this._htmlElement.onclick=this.handleOnClick.bind(this),this._imageUrl){var t=this.utils.createImage(this._imageUrl,["action-image"]);this._htmlElement.appendChild(t)}if(this._label){var e=this.utils.createDiv(["action-label"]);e.textContent=this._label,this._htmlElement.appendChild(e)}return this._disabled&&this._htmlElement.classList.add(this.utils.getCssClassWithPrefix("disabled")),this._htmlElement},t.prototype.handleOnClick=function(t){if(this.onActionClick&&!this._disabled){var e={getPayload:this.getEventPayload.bind(this),label:this._label,type:this._type};this.onActionClick(e)}},t.prototype.disable=function(){this._disabled=!0,this._htmlElement&&this._htmlElement.classList.add(this.utils.getCssClassWithPrefix("disabled"))},t.prototype.enable=function(){this._disabled=!1,this._htmlElement&&this._htmlElement.classList.remove(this.utils.getCssClassWithPrefix("disabled"))},t.prototype.getActionType=function(){return this._type},t}();e.ActionComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.GEOLOCATION_REQUEST_DENIED=1,t.CHAT_SCROLL_DELAY=300,t.WEBSOCKET_READY_STATE=["CONNECTING","OPEN","CLOSING","CLOSED"],t.WEBSOCKET_CLOSE_EVENT={CODE:{ABNORMAL_CLOSURE:1006}},t.FILE_SIZE_LIMIT_EXCEEDED=413,t.UNSUPPORTED_FILE_TYPE=415,t.FILE_SIZE_METADATA_HEADER="x-oda-meta-file-size",t.BIT_MULTIPLIER=1024,t.MAX_SUGGESTIONS_COUNT=5,t.MIN_SUGGESTIONS_COUNT=1,t}();e.Constants=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.utils=t}return t.prototype.addClass=function(t){this.element.classList.add(this.utils.getCssClassWithPrefix(t))},t.prototype.hide=function(t){void 0===t&&(t=!0),t?(this._orgDisplayStyle=this.element.style.display,this.element.style.display="none"):this.element.style.display=this._orgDisplayStyle},t.prototype.remove=function(){this.element.remove()},t.prototype.appendToElement=function(t){t.appendChild(this.element)},t.prototype.prependToElement=function(t){var e=t.firstChild;e?t.insertBefore(this.element,e):t.appendChild(this.element)},t.prototype.appendContentChildElement=function(t){this._getContentElement().appendChild(t)},t.prototype.appendContentChild=function(t){this._getContentElement().appendChild(t.element)},t.prototype._getContentElement=function(){return this.element},t}();e.Component=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SVG_SPRITE={icon_bot_attach:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.1 9.9l-12.3 12-1-1L21.7 9a3.2 3.2 0 0 0-.4-4.5c-2.4-2.4-5 0-5 0l-13 13.1a1.9 1.9 0 0 0 .1 3c1.6 1.6 2.5.2 2.5.2L19 7.8a1.3 1.3 0 0 0 .2-1.3 1.2 1.2 0 0 0-1.2.3L7.5 17.5l-1.2-1 11-11.1s2.2-1 3.3 0-.1 3-.1 3L7.2 21.9s-2 2.8-5-.1a3.4 3.4 0 0 1-.4-4.9L16.1 2.6a5.7 5.7 0 0 1 6.6 1c2.7 2.8.4 6.3.4 6.3z"/></svg>',icon_bot_button:'<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 48 48"><path d="M0 24a24 24 0 1 0 48 0 24 24 0 1 0-48 0" fill="#1b8fd2" opacity=".8"/><path d="M32.25 31.084h-7.532L19.2 37.021a1.061 1.061 0 0 1-1.251-1.316l.031-4.622h-1.23C12.47 31.084 9 28.372 9 23.97A7.862 7.862 0 0 1 16.75 16h15.5A7.862 7.862 0 0 1 40 23.97c0 4.402-3.47 7.114-7.75 7.114zM16.531 20.938a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594zm7.969-.031a2.594 2.594 0 1 0 2.594 2.593 2.594 2.594 0 0 0-2.594-2.594zm7.969.031a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594z" fill="#fff" fill-rule="evenodd"/></svg>',icon_bot_clear:'<svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="16" height="16" viewBox="0 0 16 16"><path d="M1.777 7.11 h12.446v1.78H1.777zM0 10.668h12.445v1.777H0zm3.555-7.113H16v1.777H3.555zm0 0"/></svg>',icon_bot_collapse:'<svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="16" height="16" viewBox="0 0 16 16"><path d="M.031 13H16l-.031 2H0z"/></svg>',icon_bot_logo:'<svg xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF" width="24" height="24" viewBox="0 0 24 24"><path class="svg-icon16" d="M18 16.99h-6.267L8 21.125a1.119 1.119 0 0 1-1.021-1.36V16.99H6a5.849 5.849 0 0 1-6-5.87A6.061 6.061 0 0 1 6 5h12a6.061 6.061 0 0 1 6 6.12 5.849 5.849 0 0 1-6 5.87zM6 9a2 2 0 1 0 2 2 2 2 0 0 0-2-2zm6 0a2 2 0 1 0 2 2 2 2 0 0 0-2-2zm6 0a2 2 0 1 0 2 2 2 2 0 0 0-2-2z"/></svg>',icon_bot_message_bubble:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 18"><path d="M18 12.99h-6.267L8 17.125a1.119 1.119 0 0 1-1.021-1.36V12.99H6a5.849 5.849 0 0 1-6-5.87A6.061 6.061 0 0 1 6 1h12a6.061 6.061 0 0 1 6 6.12 5.849 5.849 0 0 1-6 5.87z" fill="#d1d1d1"/><path d="M4 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleleft;animation-duration:1s;animation-iteration-count:infinite;transform-origin:20%;animation-delay:0s" fill="#fff"/><path d="M10 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScalecenter;animation-duration:1s;animation-iteration-count:infinite;transform-origin:43%;animation-delay:.2s" fill="#fff"/><path d="M16 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleright;animation-duration:1s;animation-iteration-count:infinite;transform-origin:70%;animation-delay:.4s" fill="#fff"/><style>@keyframes dotScaleleft{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScalecenter{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScaleright{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}</style></svg>',icon_bot_mic:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12,14c1.66,0 2.99,-1.34 2.99,-3L15,5c0,-1.66 -1.34,-3 -3,-3S9,3.34 9,5v6c0,1.66 1.34,3 3,3zM17.3,11c0,3 -2.54,5.1 -5.3,5.1S6.7,14 6.7,11L5,11c0,3.41 2.72,6.23 6,6.72L11,21h2v-3.28c3.28,-0.48 6,-3.3 6,-6.72h-1.7z"/></svg>',icon_bot_next:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',icon_bot_previous:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',icon_bot_send:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M.992 1.4l22.631 11.128L.859 23.436l.422-8.822 12.431-2.077L1.517 10.1z"/></svg>',icon_bot_speech_mute:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 16l-4.968-5.005H1.546A1.7 1.7 0 0 1-.019 9.109V6.751A1.572 1.572 0 0 1 1.515 4.98H3L8 0v16zm8.094-10.094L14 8.027l2.07 2.068-.926.988L13.037 9l-2.087 2.115-1.05-.989 2.114-2.137-2.076-2.051.969-1 2.074 2.072 2.081-2.1z"/></svg>',icon_bot_speech_unmute:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 16l-4.968-5.005H1.546A1.7 1.7 0 0 1-.019 9.109V6.751A1.572 1.572 0 0 1 1.515 4.98H3L8 0v16zm3.28-1.045l-.736-1.206a6.173 6.173 0 0 0 0-11.6L11.28.941a7.562 7.562 0 0 1 0 14.014zm1.695-7.007A4.8 4.8 0 0 1 9.6 12.542l-.684-1.233a3.367 3.367 0 0 0 2.646-3.361 3.367 3.367 0 0 0-2.646-3.36L9.6 3.355a4.8 4.8 0 0 1 3.375 4.593z"/></svg>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(e,n){this.utils=n,this._title=t.capitalize(e.type)}return t.capitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.prototype.createMessageElement=function(t,e){var n=this.utils.createDiv(["attachment-message"]),i=this.utils.createDiv(["attachment-icon"]);i.style.backgroundImage="url('"+t+"')";var o=this.utils.createDiv(["attachment-fileName"]),s=this.utils.createSpan(["attachment-file"]);return s.innerHTML=e,o.appendChild(s),n.appendChild(i),n.appendChild(o),n},t}();e.AttachmentComponent=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.POST_BACK="postback",t.CALL="call",t.URL="url",t.LOCATION="location"}(i||(i={})),e.ACTION_TYPE=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.TEXT="text",t.CARD="card",t.ATTACHMENT="attachment",t.LOCATION="location",t.RAW="raw",t.POSTBACK="postback",t.PROFILE="profile",t.ERROR="error",t.SUGGEST="suggest"}(i||(i={})),e.PAYLOAD_TYPE=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.DESTROY="destroy",t.MESSAGE="message",t.MESSAGE_RECEIVED="message:received",t.MESSAGE_SENT="message:sent",t.NETWORK="networkstatuschange",t.READY="ready",t.UNREAD="unreadCount",t.WIDGET_CLOSED="widget:closed",t.WIDGET_OPENED="widget:opened"}(i||(i={})),e.ChatEvent=i},function(t,e,n){"use strict";var i=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});e.createBotMessage=function(t,e,n,i){return{date:n,from:t,isRead:i,messagePayload:e}};e.createUserMessage=function(t,e,n,o){var s,r;if(t.type?r={date:n,isRead:o,messagePayload:t,userId:e}:t.messagePayload&&(r=t),null===(s=r.messagePayload)||void 0===s?void 0:s.metadata){var a=r.messagePayload,c=a.metadata,l=i(a,["metadata"]);r.messagePayload=l,r.metadata=c}return r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=n(21),s=n(22),r=n(23),a=n(15),c=n(3),l=function(){function t(){}return t.fromActionPayload=function(e,n,c){switch(n.type){case i.ACTION_TYPE.POST_BACK:return new r.PostbackActionComponent(e,n);case i.ACTION_TYPE.CALL:return new o.CallActionComponent(e,n);case i.ACTION_TYPE.LOCATION:return new s.LocationActionComponent(e,n);case i.ACTION_TYPE.URL:return new a.UrlActionComponent(e,n,c);default:return t.logger.error("Payload contains wrong action type:"+n.type),null}},t.logger=new c.Logger("ActionComponentFactory"),t}();e.ActionComponentFactory=l},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n,i){void 0===i&&(i=!1);var o=t.call(this,e,n)||this;return o._openInWindow=i,o._url=n.url,o}return o(e,t),e.prototype.render=function(){var e=this,n=t.prototype.render.call(this);return n.classList.add(this.utils.getCssClassWithPrefix("action-url")),n.classList.add(this.utils.getCssClassWithPrefix("action-postback")),n.href=this._url,this._openInWindow?n.onclick=function(){return window.open(e._url,"","height=450px,width=800px,menubar,toolbar,personalbar,status,resizable,noopener,noreferrer"),!1}:n.target="_blank",n},e.prototype.getEventPayload=function(){return Promise.resolve(this._url)},e}(n(5).ActionComponent);e.UrlActionComponent=s},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.IMAGE="image",t.VIDEO="video",t.AUDIO="audio",t.FILE="file"}(i||(i={})),e.ATTACHMENT_TYPE=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.OK=200]="OK"}(i||(i={}));var o=function(){function t(){}return t.STATUS=i,t}();e.Response=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=n(19),s=n(20),r=n(3),a=n(44),c=n(45),l=n(73),h=n(83),u=function(){function t(t,e){this._logger=new r.Logger("Main"),t.enableSpeech&&(window.WebSocket?this._speechRecognitionService=h.SpeechRecognitionService.getInstance():t.enableSpeech=!1),this._chatServerService=new l.ChatServerService(t,e,this._speechRecognitionService),this._config=this._chatServerService.getChatConfiguration(),this._utils=new a.Utils(this._config),this._eventDispatcher=o.generateEventDispatcher(),this._onLoad()}return t.prototype.connect=function(t){var e=this;t&&!this._config.clientAuthEnabled&&(this._chatServerService.setSettingsProperty("channelId",t.channelId),this._chatServerService.setSettingsProperty("userId",t.userId));var n=this._chatServerService.openConnection();return n.then((function(){e._eventDispatcher.trigger(i.ChatEvent.READY)})).catch((function(){e._eventDispatcher.trigger(i.ChatEvent.READY)})),n},t.prototype.disconnect=function(t,e){this._chatServerService.closeConnection(t,e)},t.prototype.isConnected=function(){return this._chatServerService.isConnectionOpen()},t.prototype.openChat=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform open action."):(this._widgetComponent.isOpen||this._widgetComponent.showChat(),this._eventDispatcher.trigger(i.ChatEvent.WIDGET_OPENED))},t.prototype.closeChat=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform close action."):(this._widgetComponent.isOpen&&this._widgetComponent.onClose(),this._eventDispatcher.trigger(i.ChatEvent.WIDGET_CLOSED))},t.prototype.isChatOpened=function(){return this._widgetComponent.isOpen},t.prototype.destroy=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform destroy action."):(this._widgetComponent.cancelSpeechSynthesis(),this._config.enableSpeech&&this.stopVoiceRecording(),this._config.enableAttachment&&this._chatServerService.cancelUploadAttachments(),this.disconnect(),this.closeChat(),this._widgetComponent.remove(),this._eventDispatcher.trigger(i.ChatEvent.DESTROY),this.off())},t.prototype.sendAttachment=function(t){if(t)return this._widgetComponent.uploadFile(t);this._errorEmptyParameter("sendAttachment","file")},t.prototype.sendMessage=function(t,e){if(t)return this._widgetComponent.sendMessage(t,e);this._errorEmptyParameter("sendMessage","message")},t.prototype.updateUser=function(t,e){t?this._chatServerService.updateUser(t,e):this._errorEmptyParameter("updateUser","userDetails")},t.prototype.startVoiceRecording=function(t,e){return this._config.enableSpeech?t?e?this._speechRecognitionService.startRecording(t,e):Promise.reject(new Error("Second callback parameter, onSpeechNetworkChange not provided. Can not start recording")):Promise.reject(new Error("First callback parameter, onSpeechRecognition not provided. Can not start recording.")):Promise.reject(new Error("Speech-to-text feature is not enabled. Initialize the widget with enableSpeech: true to use the service."))},t.prototype.stopVoiceRecording=function(){if(!this._config.enableSpeech)throw new Error("Speech-to-text feature is not enabled. Speech recognition service is not running.");return this._speechRecognitionService.stopRecording()},t.prototype.setDelegate=function(t){this._config.delegate=t},t.prototype.getConversationHistory=function(){var t=this._chatServerService.getMessages();return{messages:t,messagesCount:t.length,unreadCount:this._chatServerService.getUnreadMessagesCount(),userId:this._config.userId}},t.prototype.getUnreadMessagesCount=function(){if(this._config.enableHeadless)return 0;var t=this._chatServerService.getUnreadMessagesCount();return t!==this._currentUnreadCount&&(this._currentUnreadCount=t,this._eventDispatcher.trigger(i.ChatEvent.UNREAD,t)),t},t.prototype.setAllMessagesAsRead=function(){this._config.enableHeadless||(this._chatServerService.markAllAsRead(),this.getUnreadMessagesCount(),this._widgetComponent.updateNotificationBadge(0))},t.prototype.setUserInputMessage=function(t){if(this._config.enableHeadless)throw new Error("User input cannot be set in headless mode.");this._widgetComponent.setUserInputMessage(t)},t.prototype.setUserInputPlaceholder=function(t){if(this._config.enableHeadless)throw new Error("Placeholder cannot be set in headless mode.");t?this._widgetComponent.setUserInputPlaceholder(t):this._errorEmptyParameter("setUserInputPlaceholder","placeholder text")},t.prototype.getSuggestions=function(t){t?this._widgetComponent.getSuggestions(t):this._errorEmptyParameter("getSuggestions","query")},t.prototype.on=function(t,e){this._eventDispatcher.bind(t,e)},t.prototype.off=function(t,e){this._eventDispatcher.unbind(t,e)},t.prototype.setChatBubbleIconHeight=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));e<n.length;e++){n[e].style.height=t,this._config.height=t}else this._errorEmptyParameter("setChatBubbleIconHeight","height")},t.prototype.setChatBubbleIconSize=function(t,e){if(t||!e)for(var n=0,i=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));n<i.length;n++){var o=i[n];o.style.width=t,o.style.height=e,this._config.width=t,this._config.height=e}else this._errorEmptyParameter("setChatBubbleIconSize","width","height")},t.prototype.setChatBubbleIconWidth=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));e<n.length;e++){n[e].style.width=t,this._config.width=t}else this._errorEmptyParameter("setChatBubbleIconWidth","width")},t.prototype.setFont=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.font=t,this._config.font=t)}else this._errorEmptyParameter("setFont","font")},t.prototype.setFontSize=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.fontSize=t)}else this._errorEmptyParameter("setFontSize","fontSize")},t.prototype.setHeight=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];e&&(e.style.height=t,this._config.height=t)}else this._errorEmptyParameter("setHeight","height")},t.prototype.setMessagePadding=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("message-bubble"));e<n.length;e++){n[e].style.padding=t,this._config.messagePadding=t}else this._errorEmptyParameter("setMessagePadding","padding")},t.prototype.setSize=function(t,e){if(t||e){var n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];n&&(n.style.width=t,n.style.height=e,this._config.width=t,this._config.height=e)}else this._errorEmptyParameter("setSize","width","height")},t.prototype.setTextColor=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.color=t,this._config.colors.text=t)}else this._errorEmptyParameter("setTextColor","color")},t.prototype.setTextColorLight=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("card-description"));e<n.length;e++){n[e].style.color=t,this._config.colors.textLight=t}else this._errorEmptyParameter("setTextColor","color")},t.prototype.setWidth=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];e&&(e.style.width=t,this._config.width=t)}else this._errorEmptyParameter("setWidth","width")},t.prototype._errorEmptyParameter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];1===e.length?this._logger.error("Parameter "+e+" was not passed for "+t+" call. No action processed."):this._logger.error("Parameters "+e.join(", ")+" were not passed for "+t+" call. No action processed.")},t.prototype._sendMessage=function(t){this._eventDispatcher.trigger(i.ChatEvent.MESSAGE_SENT,t),this._eventDispatcher.trigger(i.ChatEvent.MESSAGE,t)},t.prototype._receiveMessage=function(t){t.from&&(this._eventDispatcher.trigger(i.ChatEvent.MESSAGE_RECEIVED,t),this._eventDispatcher.trigger(i.ChatEvent.MESSAGE,t)),this._message=t},t.prototype._onConnectionStatusChange=function(t){this._eventDispatcher.trigger(i.ChatEvent.NETWORK,t)},t.prototype._onLoad=function(){this._logger.debug("onLoad","load chat widget");var t=new c.StyleComponent(this._utils,this._config);t.addStyle(t.setWidgetCssClasses()),"undefined"!=typeof window&&document.head.appendChild(t.render()),this._createWidget(this._config.embedded)},t.prototype._createWidget=function(t){if(this._widgetComponent=new s.WidgetComponent(this._utils,this._config,this.openChat.bind(this),this.closeChat.bind(this),this._receiveMessage.bind(this),this._sendMessage.bind(this),this.getUnreadMessagesCount.bind(this),this._onConnectionStatusChange.bind(this),this._chatServerService,this._speechRecognitionService),t)try{this._widgetComponent.embedInElement(this._config.targetElement)}catch(t){this._logger.error("Target Element not specified",t)}else this._widgetComponent.appendToElement(document.body)},t}();e.default=u},function(t,e,n){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var s=arguments[e],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(e,"__esModule",{value:!0});var o=n(12);e.generateEventDispatcher=function(){var t={},e=[];return{bind:function(n,i){!n||function(){if(!e.length)for(var t=0,n=Object.keys(o.ChatEvent);t<n.length;t++){var i=n[t];e.push(o.ChatEvent[i])}return e}().indexOf(n)<0||!i||i.constructor!==Function||(t.hasOwnProperty(n)?t[n].push(i):t[n]=[i])},trigger:function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];t.hasOwnProperty(e)&&(n=null!=n?n:[],t[e].forEach((function(t){t.call.apply(t,i([null],n))})))},unbind:function(e,n){e?n?t[e]=t[e].filter((function(t){return t!==n})):t.hasOwnProperty(e)&&t[e].splice(0,t[e].length):t={}}}}},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(13),r=n(1),a=n(4),c=n(6),l=n(2),h=n(10),u=n(11),p=n(24),d=n(25),g=n(26),f=n(7),m=n(27),_=n(3),v=n(38),b=n(39),y=n(41),C=n(42),S=n(43),w=function(t){function e(e,n,i,o,s,r,c,l,h,u){var p=t.call(this,e)||this;return p.settings=n,p.openChat=i,p.closeChat=o,p.receiveMessage=s,p.sentMessage=r,p.getUnreadMessagesCount=c,p.onConnectionStatusChange=l,p.dataService=h,p._speechRecognitionService=u,p.WAITING_RESPONSE_INDICATOR_TIMEOUT=1e3*p.settings.typingIndicatorTimeout,p.NO_SPEECH_STATUS_TIMEOUT=4e3,p._logger=new _.Logger("ChatComponent"),p._previousBotMessage=[],p._currentSessionBotMessages=[],p._consecutiveBotMessagesCount=0,p._attachmentDivs=[],p._unreadMessages=[],p.registerStatusCallback=function(t){p.dataService.onStatusChange=function(e){if(p._isFirstConnect&&p._loadPreviousConversations(),Number.isInteger(e)&&e!==a.CONNECTION_STATE.OPEN){p._chatFooterComponent.isDisabled()||(p._chatFooterComponent.disable(),p._logger.debug("WebSocket not open, send message button disabled")),p._disableBotMessages(p._currentSessionBotMessages),p._removeChatBubble(),p._consecutiveBotMessagesCount&&p._currentSessionBotMessages.splice(0,p._currentSessionBotMessages.length-p._consecutiveBotMessagesCount);for(var n=0,i=p._attachmentDivs;n<i.length;n++){var o=i[n];p._handleUploadError(o.fileName,500,o.divId)}}else p._chatFooterComponent.isDisabled()&&(p._chatFooterComponent.disable(!1),p._logger.debug("Connection established, send message button enabled")),p._enableBotMessages();t(e),p.onConnectionStatusChange(e)}},p.element=p._createElement(),p.isOpen=n.openChatOnLoad,p._isFirstConnect=!0,p._localeText=n.i18n[n.locale],p._narrationEnabled=n.enableBotAudioResponse,p._narrationEnabled&&(p._setupSpeechSynthesis(),p._narrationEnabled=!p.settings.initBotAudioMuted),"function"!=typeof l&&(p.onConnectionStatusChange=function(){}),p}return o(e,t),e.prototype.render=function(t){},e.prototype.embedInElement=function(t){var e=this,n=document.getElementById(t);if(!n)throw new Error("Can not embed chat widget.");var i=function(){e.chatWidgetDiv.style.width=n.clientWidth+"px",e.chatWidgetDiv.style.height=n.clientHeight+"px",e.chatWidgetDiv.style.position="inherit",e.chatWidgetDiv.style.boxShadow="none"};i(),this.appendToElement(n),this.resizeEventListener=function(){i()},window.addEventListener("resize",this.resizeEventListener)},e.prototype.showChat=function(){var t=this;this.isOpen||(this.element.classList.remove(this.utils.getCssClassWithPrefix("collapsed")),this.element.classList.add(this.utils.getCssClassWithPrefix("expanded")),this.chatWidgetDiv.classList.remove(this.utils.getCssClassWithPrefix("none")),setTimeout((function(){t._botButton.classList.add(t.utils.getCssClassWithPrefix("none"))}),250),this.isOpen=!0,this._updateUnreadMessages(),this._scrollToBottom(),this._chatFooterComponent.focusTextArea())},e.prototype.onClose=function(){var t=this;if(this.isOpen){this._textToSpeechCancel(),this.element.classList.remove(this.utils.getCssClassWithPrefix("expanded")),this.element.classList.add(this.utils.getCssClassWithPrefix("collapsed")),this._botButton.classList.remove(this.utils.getCssClassWithPrefix("none")),setTimeout((function(){t.chatWidgetDiv.classList.add(t.utils.getCssClassWithPrefix("none")),t._botButton.focus()}),250);var e=this.getUnreadMessagesCount();e>0?this._botButton.appendChild(this._botNotificationBadge):this._botNotificationBadge&&this._botNotificationBadge.remove(),this._botNotificationBadge.innerText=""+e,this.isOpen=!1}},e.prototype.updateNotificationBadge=function(t){this.isOpen||(t>0?this._botButton.appendChild(this._botNotificationBadge):(this._botNotificationBadge&&this._botNotificationBadge.remove(),this._unreadMessages=[]))},e.prototype.onToggleNarration=function(t){this._toggleNarration(t)},e.prototype.remove=function(){t.prototype.remove.call(this),this.dataService.onMessage=function(){},this.settings.embedded&&window.removeEventListener("resize",this.resizeEventListener)},e.prototype.clearMessage=function(){localStorage.setItem(this.settings.name+"-"+this.settings.userId+"-messages",JSON.stringify([])),this._conversationContainer.innerHTML="",this._renderMessages([],!1),this._textToSpeechCancel()},e.prototype.setUserInputMessage=function(t){this._chatFooterComponent.setUserInputText(t,!0)},e.prototype.setUserInputPlaceholder=function(t){this._chatFooterComponent.setUserInputPlaceholder(t)},e.prototype.triggerPostback=function(t,e){var n,i=this,o=t.match(/[a-zA-Z]+/g)[0],r=+t.match(/\d+/g)[0];if("card"===o){var a=m.MessageComponentFactory.fromMessage(this.utils,this.settings,e,this._markAsRead.bind(this));n=a.cards.length>=r?a.cards[r-1].handleOnActionTrigger(t):null}else{a=m.MessageComponentFactory.fromMessage(this.utils,this.settings,e,this._markAsRead.bind(this));n=a.handleOnActionTrigger(t)}n&&n.getEventPayload().then((function(t){var e=s.createUserMessage({postback:t,text:n.label,type:u.PAYLOAD_TYPE.POSTBACK},i.settings.userId,new Date,!0);i._sendMessageToServer(e)}))},e.prototype.onMessageActionClicked=function(t){var n=this;if(t.type===h.ACTION_TYPE.POST_BACK)this._scrollToBottom(),"none"!==this.settings.disablePastActions&&t.messageComponent.disableActions(),t.getPayload().then((function(e){var i=s.createUserMessage({postback:e,text:t.label,type:u.PAYLOAD_TYPE.POSTBACK},n.settings.userId,new Date,!0);t.label===n._localeText.retryMessage?n.dataService.retryMessage(i):n._sendMessageToServer(i)}));else if(t.type===h.ACTION_TYPE.LOCATION){var i=document.getElementById(e.MESSAGES_ID),o=new b.LoadingMessageComponent(this._localeText.requestLocation,r.MESSAGE_SIDE.LEFT,this.utils);i.appendChild(o.render()),this._scrollToBottom(),"none"!==this.settings.disablePastActions&&t.messageComponent.disableActions(),t.getPayload().then((function(e){o.remove();var i=s.createUserMessage({location:{latitude:e.latitude,longitude:e.longitude,title:"@Share Location"===t.label?"@demo location":void 0},type:u.PAYLOAD_TYPE.LOCATION},n.settings.userId,new Date,!0);n._sendMessageToServer(i)})).catch((function(t){if(t.code===c.Constants.GEOLOCATION_REQUEST_DENIED){var e=new y.MessageStringComponent(n._localeText.requestLocationString,r.MESSAGE_SIDE.LEFT,n.utils);o.remove(),i.appendChild(e.render(n.settings.errorIcon))}}))}},e.prototype.sendMessage=function(t,e){var n,i=!1;if(!t)return this._logger.error("No message passed to send to bot"),i;if(n="string"==typeof t?{text:t,type:u.PAYLOAD_TYPE.TEXT}:t){var o=s.createUserMessage(n,this.settings.userId,new Date,!0);i=this._sendMessageToServer(o,e)}else this._logger.error("Can not parse payload from message",t);return i},e.prototype.uploadFile=function(t){var n=this;return this._textToSpeechCancel(),new Promise((function(i,o){var s;if(n.settings.enableHeadless)n.dataService.uploadAttachment(t).then((function(t){i(t)})).catch((function(t){o(t)}));else{n._scrollToBottom();var a=new Date,l=(null===(s=t.name)||void 0===s?void 0:s.replace(/[\s:\'"\\/\[\]~,\.;^`()@#%\*+=$&!{}?<>|]/g,""))+1e4*(Math.random()+Date.parse(a.toDateString())+a.getTime())%1e8,h=n.utils.createDiv();if(h.id=l,n._attachmentDivs.push({divId:l,fileName:t.name}),document.getElementById(e.MESSAGES_ID).appendChild(h),t.size>n.settings.maxAttachmentFileSize*c.Constants.BIT_MULTIPLIER*c.Constants.BIT_MULTIPLIER)n._scrollToBottom(),n._handleUploadError(t.name,c.Constants.FILE_SIZE_LIMIT_EXCEEDED,l),o("Can not upload attachment, file size should not be more than 25MB.");else{var u=new b.LoadingMessageComponent(t.name,r.MESSAGE_SIDE.RIGHT,n.utils);h.appendChild(u.render()),n._scrollToBottom(),n.dataService.uploadAttachment(t,n._handleUploadError.bind(n),l,!0).then((function(t){i(t)})).catch((function(t){o(t)}))}}}))},e.prototype.cancelSpeechSynthesis=function(){this._textToSpeechCancel()},e.prototype.getSuggestions=function(t){if(!this.settings.enableAutocompleteClientCache||this.settings.enableAutocompleteClientCache&&!this._chatFooterComponent.getSuggestionsValid()){var e=this.settings.numberOfSuggestionsFromServer,n=s.createUserMessage({query:t,threshold:e,type:u.PAYLOAD_TYPE.SUGGEST},this.settings.userId,new Date,!0);this.dataService.getSuggestions(n)}else{var i=this._filterSuggestions(this._chatFooterComponent.getSuggestions(),t);null!=this._chatFooterComponent&&this._chatFooterComponent.displaySuggestions(i)}},e.prototype._filterSuggestions=function(t,e){for(var n=[],i=0,o=t;i<o.length;i++){var s=o[i];-1!==s.search(new RegExp(e,"i"))&&n.push(s)}return n},e.prototype._handleUploadError=function(t,e,n){var i;switch(e){case c.Constants.FILE_SIZE_LIMIT_EXCEEDED:i=t+" - "+this._localeText.uploadFileSizeLimitExceeded;break;case c.Constants.UNSUPPORTED_FILE_TYPE:i=t+" - "+this._localeText.uploadUnsupportedFileType;break;default:i=t+" - "+this._localeText.uploadFailed}var o=new y.MessageStringComponent(i,r.MESSAGE_SIDE.LEFT,this.utils),s=document.getElementById(n);s.firstElementChild&&s.removeChild(s.firstElementChild),this._attachmentDivs=this._attachmentDivs.filter((function(t){return t.divId!==n})),s.appendChild(o.render(this.settings.errorIcon))},e.prototype._createElement=function(){var t=this.settings.locale,n=this.utils.createDiv(this.settings.embedded?[]:["wrapper"]);n.addEventListener("click",function(){"speechSynthesis"in window&&(speechSynthesis.cancel(),speechSynthesis.resume(),speechSynthesis.speak(new SpeechSynthesisUtterance("")))}.bind(this),{once:!0}),this.chatWidgetDiv=this.utils.createDiv(["widget"]);var i=new d.WidgetHeaderComponent(this.utils,this.settings,this.closeChat.bind(this),this.clearMessage.bind(this),this.onToggleNarration.bind(this),this.registerStatusCallback.bind(this));if(this.chatWidgetDiv.appendChild(i.element),this.settings.embedTopStickyId)try{var o=this.utils.createDiv(["embed-sticky-top"]);o.appendChild(document.getElementById(this.settings.embedTopStickyId)),this.chatWidgetDiv.appendChild(o)}catch(t){this._logger.error("No element present with id "+this.settings.embedTopStickyId+". Can not embed pinned content.")}if(this._conversationComponent=new g.WidgetMainComponent(this.utils,this.settings),this._conversationComponent.element.id=e.CHAT_MESSAGES_PARENT_ID,this._conversationComponent.element.addEventListener("scroll",this._updateUnreadMessages.bind(this)),this._scrollContent=this.utils.createDiv(["conversation-pane"]),this.settings.embedTopScrollId)try{var s=this.utils.createDiv(["embed-scroll-top"]);s.appendChild(document.getElementById(this.settings.embedTopScrollId)),this._scrollContent.appendChild(s)}catch(t){this._logger.error("No element present with id "+this.settings.embedTopScrollId+". Can not embed scrollable content.")}var r=this.utils.createDiv("bottom"===this.settings.conversationBeginPosition?["empty-conversation-div"]:void 0);if(this._scrollContent.appendChild(r),this._conversationContainer=this.utils.createDiv(["conversation-container"]),this._conversationContainer.id=e.MESSAGES_ID,this._scrollContent.appendChild(this._conversationContainer),this._conversationComponent.element.appendChild(this._scrollContent),this.settings.embedBottomScrollId)try{var a=this.utils.createDiv(["embed-scroll-bottom"]);a.appendChild(document.getElementById(this.settings.embedBottomScrollId)),this._conversationComponent.element.appendChild(a)}catch(t){this._logger.error("No element present with id "+this.settings.embedBottomScrollId+". Can not embed scrollable content.")}if(this.chatWidgetDiv.appendChild(this._conversationComponent.element),this.settings.embedBottomStickyId)try{var c=this.utils.createDiv(["embed-sticky-bottom"]);c.appendChild(document.getElementById(this.settings.embedBottomStickyId)),this.chatWidgetDiv.appendChild(c)}catch(t){this._logger.error("No element present with id "+this.settings.embedBottomStickyId+". Can not embed pinned content.")}if(this._chatFooterComponent=new p.ChatFooterComponent(this.utils,this.sendMessage.bind(this),this.uploadFile.bind(this),this.settings,this.getSuggestions.bind(this),this.onSpeechToggle.bind(this)),this.chatWidgetDiv.appendChild(this._chatFooterComponent.element),n.appendChild(this.chatWidgetDiv),this.settings.embedded)this.isOpen=!0,n.classList.add(this.utils.getCssClassWithPrefix("open"));else{this._botButton=this.utils.createButton(["button"]),this._botButton.title=this.settings.i18n[t].chatTitle;var l=this.utils.createImage(this.settings.botButtonIcon,["button-icon"],this.settings.i18n[t].chatTitle);this._botButton.appendChild(l),this._botButton.onclick=this.openChat.bind(this),this._botNotificationBadge=this.utils.createDiv(["notification-badge"]);var h=this.getUnreadMessagesCount();this._botNotificationBadge.innerText=""+h,h>0&&this._botButton.appendChild(this._botNotificationBadge),n.appendChild(this._botButton),this.settings.openChatOnLoad?(n.classList.add(this.utils.getCssClassWithPrefix("expanded")),this._botButton.classList.add(this.utils.getCssClassWithPrefix("none"))):(n.classList.add(this.utils.getCssClassWithPrefix("collapsed")),this.chatWidgetDiv.classList.add(this.utils.getCssClassWithPrefix("none")))}return n},e.prototype._scrollToBottom=function(){var t=document.getElementById(e.CHAT_MESSAGES_PARENT_ID);setTimeout((function(){t&&(t.scrollTop=t.scrollHeight)}),c.Constants.CHAT_SCROLL_DELAY)},e.prototype._renderMessages=function(t,e,n){for(var i=this,o=0,s=t.length,r=0,a=t;r<a.length;r++){var c=a[r];o++;var l=m.MessageComponentFactory.fromMessage(this.utils,this.settings,c,this._markAsRead.bind(this),this._isURLReachable.bind(this),e);if(e||("none"!==this.settings.disablePastActions&&(c.from?this._previousBotMessage.push(l):(this._disableBotMessages(this._previousBotMessage),this._previousBotMessage=[])),c.from?(this._currentSessionBotMessages.push(l),this._consecutiveBotMessagesCount++):this._consecutiveBotMessagesCount=0),n){var h=document.getElementById(n);h.removeChild(h.firstElementChild),h.appendChild(l.render()),this._attachmentDivs=this._attachmentDivs.filter((function(t){return t.divId!==n}))}else{var u=l.render();this._conversationContainer.appendChild(u);var p={component:l,element:u};this._markMessageAsReadIfVisible(p),this._unreadMessages.push(p)}l.onActionClick=this.onMessageActionClicked.bind(this),e&&o<=s&&l.disableActions(e)}this.settings.embedded||this.isOpen||e||setTimeout((function(){var t=i.getUnreadMessagesCount();t>0&&(i._botNotificationBadge.innerText=""+t,i._botButton.appendChild(i._botNotificationBadge))}))},e.prototype._isMobileDevice=function(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},e.prototype.onSpeechToggle=function(t){var e=this;this._textToSpeechCancel(),this.settings.enableSpeech&&(t?(this._removeNoSpeechStatusMessage(),this._speechRecognitionService.startRecording(this.onSpeechRecognition.bind(this),this.onSpeechNetworkChange.bind(this)).then((function(){e._chatFooterComponent.setVoiceRecording(!0)})).catch((function(t){e._logger.error(t.message),e._chatFooterComponent.setVoiceRecording(!1)}))):(this._speechRecognitionService.stopRecording(),this._chatFooterComponent.setVoiceRecording(!1)))},e.prototype.onSpeechRecognition=function(t){var e,n,i,o,s=this;if(t)switch(t.event){case"finalResult":if((null===(n=null===(e=t)||void 0===e?void 0:e.nbest)||void 0===n?void 0:n.length)>0)(r=t.nbest[0].utterance).length>0?this.settings.enableSpeechAutoSend?(this.sendMessage(r),this._chatFooterComponent.setUserInputText("")):this._chatFooterComponent.setUserInputText(r,!0):this._chatFooterComponent.setUserInputText("",!0);else this._noSpeechTimeoutStatus=new C.StatusComponent(this.settings.i18n[this.settings.locale].noSpeechTimeout,this.utils,this.settings.errorIcon).render(),this._conversationContainer.appendChild(this._noSpeechTimeoutStatus),setTimeout((function(){s._removeNoSpeechStatusMessage()}),this.NO_SPEECH_STATUS_TIMEOUT);this._speechRecognitionService.stopRecording();break;case"partialResult":var r;if((null===(o=null===(i=t)||void 0===i?void 0:i.nbest)||void 0===o?void 0:o.length)>0)(r=t.nbest[0].utterance).length>0&&this._chatFooterComponent.setUserInputText(r)}},e.prototype.onSpeechNetworkChange=function(t){this._chatFooterComponent.setVoiceRecording(t===a.CONNECTION_STATE.OPEN)},e.prototype._disableBotMessages=function(t){for(var e=0,n=t;e<n.length;e++){n[e].disableActions()}},e.prototype._enableBotMessages=function(){for(var t=0,e=this._currentSessionBotMessages;t<e.length;t++){e[t].enableActions()}},e.prototype._markAsRead=function(t){this.dataService.markAsRead(t)},e.prototype._onMessageReceived=function(t,e){this._logger.debug("onMessageReceived",t),this._removeChatBubble(),this._renderMessages([t],!1,e),this.receiveMessage(t),this._scrollToBottom(),t.from&&this._textToSpeechSpeak(m.MessageComponentFactory.extractUtteranceText(t,this.settings.i18n[this.settings.locale]))},e.prototype._toggleNarration=function(t){t?this._textToSpeechResume():this._textToSpeechCancel(),this._narrationEnabled=t},e.prototype._onSuggestionsReceived=function(t){null!=t&&t.suggestions&&t.suggestions.length>0&&null!=this._chatFooterComponent&&this._chatFooterComponent.displaySuggestions(t.suggestions)},e.prototype._removeChatBubble=function(){this._chatBubbleDiv&&this._chatBubbleDiv.remove()},e.prototype._removeNoSpeechStatusMessage=function(){this._noSpeechTimeoutStatus&&(this._noSpeechTimeoutStatus.remove(),this._noSpeechTimeoutStatus=void 0)},e.prototype._sendMessageToServer=function(t,e){var n=this;this._scrollToBottom(),this._textToSpeechCancel();var i=this.dataService.send(t,null,null,e);return this.sentMessage(t),this._isMobileDevice()||this._chatFooterComponent.focusTextArea(),this._chatFooterComponent.getSuggestionsValid(),this.settings.showTypingIndicator&&(this._chatBubbleDiv=new v.ChatBubbleComponent(r.MESSAGE_SIDE.LEFT,this.utils,this.settings),this._conversationContainer.appendChild(this._chatBubbleDiv.render()),setTimeout((function(){n._removeChatBubble()}),this.WAITING_RESPONSE_INDICATOR_TIMEOUT),this._scrollToBottom()),i},e.prototype._updateUnreadMessages=function(){var t=this;if(this.isOpen){var e=[];this._unreadMessages.forEach((function(n){t._markMessageAsReadIfVisible(n)||e.push(n)})),this._unreadMessages=e}},e.prototype._markMessageAsReadIfVisible=function(t){var e=!1;return this.isOpen&&l.utils.isDivVisible(this._conversationComponent.element,t.element)&&(t.component.updateMarkAsRead(),e=!0),e},e.prototype._loadPreviousConversations=function(){this._isFirstConnect=!1;var t=this.dataService.loadChat();this.settings.enableLocalConversationHistory&&t.length>0&&(this._renderMessages(t.slice(),!0),this.settings.showPrevConvStatus&&(this._conversationContainer.appendChild(new C.StatusComponent(this.settings.i18n[this.settings.locale].previousChats,this.utils).render()),this._conversationContainer.appendChild(document.createElement("hr"))),this._scrollToBottom()),this.dataService.onMessage=this._onMessageReceived.bind(this),this.dataService.onSuggestions=this._onSuggestionsReceived.bind(this)},e.prototype._isURLReachable=function(t){return this.dataService.isURLReachable(t)},e.prototype._setupSpeechSynthesis=function(){var t;try{this._speechSynthesisService=S.SpeechSynthesisService.getInstance(),(null===(t=this.settings.skillVoices)||void 0===t?void 0:t.length)&&this._speechSynthesisService.setVoice(this.settings.skillVoices)}catch(t){this._narrationEnabled=!1}},e.prototype._textToSpeechSpeak=function(t){this._narrationEnabled&&this._speechSynthesisService&&this._speechSynthesisService.speak(t)},e.prototype._textToSpeechResume=function(){this._narrationEnabled&&this._speechSynthesisService&&this._speechSynthesisService.resume()},e.prototype._textToSpeechCancel=function(){this._narrationEnabled&&this._speechSynthesisService&&this._speechSynthesisService.cancel()},e.MESSAGES_ID="ochat_widget_messages",e.CHAT_MESSAGES_PARENT_ID="chat_widget_main",e}(f.Component);e.WidgetComponent=w},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._phoneNumber=n.phoneNumber,i}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-call")),e.href="tel:"+this._phoneNumber,e},e.prototype.getEventPayload=function(){return Promise.resolve(this._phoneNumber)},e}(n(5).ActionComponent);e.CallActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-location")),e},e.prototype.getEventPayload=function(){return this.getCurrentPosition()},e.prototype.getCurrentPosition=function(){return new Promise((function(t,e){setTimeout((function(){navigator.geolocation.getCurrentPosition((function(e){t({latitude:e.coords.latitude,longitude:e.coords.longitude})}),(function(t){e(t)}))}))}))},e}(n(5).ActionComponent);e.LocationActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._postback=n.postback,i}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-postback")),e},e.prototype.getEventPayload=function(){return Promise.resolve(this._postback)},e}(n(5).ActionComponent);e.PostbackActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s,r,a=n(2),c=n(7),l=n(6),h=n(8);!function(t){t.ARROW_DOWN="ArrowDown",t.ARROW_UP="ArrowUp",t.BACKSPACE="Backspace",t.ENTER="Enter"}(s||(s={})),function(t){t.ARROW_DOWN="ArrowDown",t.ARROW_UP="ArrowUp",t.ENTER="Enter"}(r||(r={}));var u=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e)||this;return a.onSend=n,a.onUpload=i,a.settings=o,a.onQueryChange=s,a.onSpeechToggle=r,a.SUGGESTION_REQUEST_TIMEOUT=300,a.SUGGESTION_MINIMUM_INPUT_LENGTH=3,a._isSpeechActive=!1,a._isSpeechRecording=!1,a._navKeys=[],a.element=a._createElement(),a}return o(e,t),e.prototype.setUserInputText=function(t,e){void 0===e&&(e=!1),this._textArea&&(this._textArea.value=t,e&&this.updateSendSpeechIcon())},e.prototype.setUserInputPlaceholder=function(t){this._textArea&&(this._textArea.placeholder=t)},e.prototype.setVoiceRecording=function(t){this.settings.enableSpeech&&(this._isSpeechRecording=t,t?this._sendButton.firstElementChild.classList.add(this.utils.getCssClassWithPrefix("button-speech-active")):this._sendButton.firstElementChild.classList.remove(this.utils.getCssClassWithPrefix("button-speech-active")))},e.prototype.focusTextArea=function(){this._textArea.focus()},e.prototype.render=function(t){},e.prototype.disable=function(t){void 0===t&&(t=!0),this._sendButton.disabled=t,this.settings.enableAttachment&&(this._uploadButton.disabled=t),t?(this._textArea.classList.add(this.utils.getCssClassWithPrefix("disabled")),this.settings.enableAutocomplete&&(this._invalidateSuggestions(),this._removeSuggestionsPopup())):this._textArea.classList.remove(this.utils.getCssClassWithPrefix("disabled"))},e.prototype.isDisabled=function(){return this._sendButton.disabled},e.prototype.displaySuggestions=function(t){var n=this;if(this._removeSuggestionsPopup(),0===t.length)this._suggestions=t,this._isSuggestionsValid=!1;else if(this._textArea.value){this._currentSuggestionFocus=t.length>l.Constants.MAX_SUGGESTIONS_COUNT?l.Constants.MAX_SUGGESTIONS_COUNT:t.length<l.Constants.MIN_SUGGESTIONS_COUNT?l.Constants.MIN_SUGGESTIONS_COUNT:t.length,this._suggestions=t,this._isSuggestionsValid=!0;var i=this.utils.createDiv(["autocomplete-items"]),o=this._textArea.value.trim();i.id=e.SUGGESTIONS_ID;for(var s=function(e){var s=r.utils.createDiv(),a=r._emboldenMatch(t[e],o);s.innerHTML=a,s.onclick=function(){n._textArea.value=s.innerText,n._removeSuggestionsPopup(),n._sendButton.click()},i.appendChild(s)},r=this,a=this._currentSuggestionFocus-1;a>-1;a--)s(a);this.element.appendChild(i)}},e.prototype.getSuggestions=function(){return this._suggestions},e.prototype.getSuggestionsValid=function(){return this._isSuggestionsValid},e.prototype._createElement=function(){var t=this.settings.locale,e=this.utils.createDiv(["footer"]);if(this.settings.enableAttachment){this._uploadButton=this.utils.createButton(["footer-button","button-upload"]),this._uploadButton.title=this.settings.i18n[t].upload;var n=this.settings.attachmentIcon||h.SVG_SPRITE.icon_bot_attach;if(a.utils.isSvg(n)){var i=this.utils.createElementFromString(n),o=this.utils.getCssClassWithPrefix("footer-button-svg-icon");i.classList.add(o),this._addHoverStyle(o),this._uploadButton.appendChild(i)}else{i=this.utils.createImage(n,["footer-button-icon"]);this._uploadButton.appendChild(i)}this._uploadButton.onclick=this._triggerUploadDocument.bind(this),e.appendChild(this._uploadButton),this._uploadFileInput=this.utils.createInput([],"file"),this._uploadFileInput.onchange=this._uploadDocument.bind(this),this._uploadFileInput.accept=this.settings.supportedFileTypes}return this._textArea=this.utils.createTextArea(["user-input"]),this._textArea.onkeydown=this.onInputKeyDown.bind(this),this.settings.enableAutocomplete&&(this._textArea.onkeyup=this.onInputKeyUp.bind(this)),this._textArea.oninput=this._expand.bind(this),this._textArea.placeholder=this.settings.i18n[t].inputPlaceholder,this._textArea.autofocus=!0,this._textArea.style.font=this.settings.font,this._textArea.rows=1,this._textArea.setAttribute("aria-label",this.settings.i18n[t].inputPlaceholder),e.appendChild(this._textArea),this._sendButton=this.utils.createButton(["footer-button","button-send"]),this.updateSendSpeechIcon(),this._sendButton.onclick=this._onClickSend.bind(this),e.appendChild(this._sendButton),this.disable(!0),e},e.prototype._isUserInputEmpty=function(){return!this._textArea||0===this._textArea.value.trim().length},e.prototype._setSendSpeakButton=function(t,e,n){this._sendButton.innerHTML="",this._sendButton.title=t;var i=null!=n?n:e;if(a.utils.isSvg(i)){var o=this.utils.createElementFromString(i),s=this.utils.getCssClassWithPrefix("footer-button-svg-icon");o.classList.add(s),this._addHoverStyle(s),this._sendButton.appendChild(o)}else this._sendButtonIcon=this.utils.createImage(i,["footer-button-icon"]),this._sendButton.appendChild(this._sendButtonIcon)},e.prototype.updateSendSpeechIcon=function(){var t=this.settings.locale;this.settings.enableSpeech&&this._isUserInputEmpty()?(this._setSendSpeakButton(this.settings.i18n[t].speak,h.SVG_SPRITE.icon_bot_mic,this.settings.micIcon),this._isSpeechActive=!0):(this._setSendSpeakButton(this.settings.i18n[t].send,h.SVG_SPRITE.icon_bot_send,this.settings.sendIcon),this._isSpeechActive=!1)},e.prototype._onClickSend=function(){var t,e;this.settings.enableSpeech&&this._isSpeechActive?(this._isSpeechRecording=!this._isSpeechRecording,this.onSpeechToggle(this._isSpeechRecording)):this._isUserInputEmpty()||(this._textArea.value=null===(e=null===(t=this._textArea)||void 0===t?void 0:t.value.trim())||void 0===e?void 0:e.replace("\n",""),this._onSend(),this._invalidateSuggestions(),this._removeSuggestionsPopup())},e.prototype._uploadDocument=function(t){t.target.files&&t.target.files.length>0&&this._onUpload(t.target.files[0])},e.prototype._addHoverStyle=function(t){var e="."+t+":hover {fill: "+this.settings.colors.branding+";}";this.utils.addStyleToHTML(this.utils.createStyle(e))},e.prototype.onInputKeyDown=function(t){var e;this.isDisabled()||t.isComposing||229===t.keyCode||t.key===s.ENTER&&!t.shiftKey&&(null===(e=this._textArea.value)||void 0===e?void 0:e.trim().length)>0&&(t.preventDefault(),this._previousInputValue=void 0,this._textArea.value=this._textArea.value.trim(),this.settings.enableAutocomplete&&(this._invalidateSuggestions(),this._removeSuggestionsPopup()),this._onSend())},e.prototype.onInputKeyUp=function(t){var e;if(this.isDisabled())return this._invalidateSuggestions(),void this._removeSuggestionsPopup();if(!t.isComposing&&this.settings.enableAutocomplete){if(this._onNavigateSuggestion(t))return;t.key===s.BACKSPACE&&(this._previousInputValue=void 0,this._invalidateSuggestions(),this._removeSuggestionsPopup(),clearTimeout(this._suggestionsRequest)),this._getNavKeys().indexOf(t.key)<0&&((null===(e=this._textArea.value)||void 0===e?void 0:e.trim().length)>=this.SUGGESTION_MINIMUM_INPUT_LENGTH?this._previousInputValue!==this._textArea.value&&(this._previousInputValue=this._textArea.value,clearTimeout(this._suggestionsRequest),this._setSuggestionsRequestTimer()):(this._previousInputValue=void 0,this._removeSuggestionsPopup(),clearTimeout(this._suggestionsRequest)))}},e.prototype._onNavigateSuggestion=function(t){var n=!1,i=document.getElementById(e.SUGGESTIONS_ID);if(i){var o=i.getElementsByTagName("div");t.key===s.ARROW_DOWN?(t.preventDefault(),this._currentSuggestionFocus<o.length-1?(this._currentSuggestionFocus++,this._addActive(o)):(this._removeActive(o),this._textArea.value=this._currentInputValue?this._currentInputValue:this._textArea.value,this._currentSuggestionFocus=o.length),n=!0):t.key===s.ARROW_UP&&(t.preventDefault(),this._currentSuggestionFocus===o.length&&(this._currentInputValue=this._textArea.value),this._currentSuggestionFocus>0&&this._currentSuggestionFocus--,this._addActive(o),n=!0)}return n},e.prototype._addActive=function(t){if(!t)return!1;this._removeActive(t),t[this._currentSuggestionFocus].classList.add(this.utils.getCssClassWithPrefix("autocomplete-active")),this._textArea.value=t[this._currentSuggestionFocus].innerText},e.prototype._removeActive=function(t){for(var e=0,n=t;e<n.length;e++){n[e].classList.remove(this.utils.getCssClassWithPrefix("autocomplete-active"))}},e.prototype._removeSuggestionsPopup=function(){var t=document.getElementById(e.SUGGESTIONS_ID);t&&t.remove()},e.prototype._onSend=function(){var t,e;null===(e=null===(t=this._textArea.value)||void 0===t?void 0:t.trim())||void 0===e||e.replace("\n",""),this.onSend(this._textArea.value),this._textArea.value="",this._textArea.innerText="",setTimeout(this._expand.bind(this))},e.prototype._triggerUploadDocument=function(){this._uploadFileInput.click()},e.prototype._onUpload=function(t){this.onUpload(t),this._uploadFileInput.value=""},e.prototype._onQueryChange=function(){this.onQueryChange(this._textArea.value.trim())},e.prototype._setSuggestionsRequestTimer=function(){var t=this;this._suggestionsRequest=setTimeout((function(){t._onQueryChange()}),this.SUGGESTION_REQUEST_TIMEOUT)},e.prototype._expand=function(){this.updateSendSpeechIcon(),this._textArea.style.height=null;var t=this._textArea.scrollHeight;this._textArea.style.height=t+"px"},e.prototype._invalidateSuggestions=function(){this._suggestions=null,this._isSuggestionsValid=!1},e.prototype._getNavKeys=function(){if(!this._navKeys.length)for(var t=0,e=Object.keys(r);t<e.length;t++){var n=e[t];this._navKeys.push(r[n])}return this._navKeys},e.prototype._emboldenMatch=function(t,e){var n=new RegExp(e,"i"),i=t.match(n);return i?t.substr(0,i.index)+"<strong>"+t.substr(i.index,e.length)+"</strong>"+t.substr(i.index+e.length):t},e.SUGGESTIONS_ID="chat_widget_suggestions",e}(c.Component);e.ChatFooterComponent=u},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(2),r=n(7),a=n(4),c=n(8),l=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e)||this;return a.settings=n,a.onClose=i,a.onClearMessage=o,a.onAudioToggle=s,a.element=a._createElement(),r(a._updateStatusMessage.bind(a)),a}return o(e,t),e.prototype.render=function(t){},e.prototype.closeWidgetPopup=function(){this.onClose()},e.prototype.clearHistory=function(){this.onClearMessage()},e.prototype._createElement=function(){var t,e,n=this,i=this.utils.createDiv(["header"]),o=this.utils.createDiv(["header-info-wrapper"]),r=this.utils.createDiv(["header-actions"]),a=this.settings.locale,l=this.settings.i18n[a].chatTitle,h=this.settings.i18n[a].chatSubtitle;if(this.settings.logoIcon){var u=this.utils.createImage(this.settings.logoIcon,["logo"],this.settings.i18n[a].chatTitle);i.appendChild(u)}if(l){var p=this.utils.createDiv(["title"]);p.innerText=l,p.title=l,o.appendChild(p)}if(h){var d=this.utils.createDiv(["subtitle"]);d.innerText=h,d.title=h,o.appendChild(d),this.settings.showConnectionStatus=!1}else this.settings.showConnectionStatus&&(this._connectionStatus=this.utils.createDiv(["connection-status","disconnected"]),this._connectionStatus.innerText=this.settings.i18n[a].connecting,o.appendChild(this._connectionStatus));if(i.appendChild(o),this.settings.customHeaderElementId){var g=this.utils.createDiv(["header-custom-element"]),f=document.getElementById(this.settings.customHeaderElementId);g.appendChild(f),i.appendChild(g)}if(this.settings.enableClearMessage){var m=this.utils.createButton(["header-button","button-clear"]);m.title=this.settings.i18n[a].clear;var _=null!=(t=this.settings.clearMessageIcon)?t:c.SVG_SPRITE.icon_bot_clear;if(s.utils.isSvg(_)){var v=this.utils.createElementFromString(_,["header-button-icon"]);m.appendChild(v)}else{var b=this.utils.createImage(_,["header-button-img-icon"]);m.appendChild(b)}m.onclick=this.clearHistory.bind(this),r.appendChild(m)}if(this.settings.enableBotAudioResponse&&window.speechSynthesis){this._audioButtonOn=!this.settings.initBotAudioMuted;var y,C,S=this.utils.createButton(["header-button","button-narration"]),w=function(){var t,e;S.innerHTML="";var i=n._audioButtonOn?null!=(t=n.settings.audioResponseOnIcon)?t:c.SVG_SPRITE.icon_bot_speech_unmute:null!=(e=n.settings.audioResponseOffIcon)?e:c.SVG_SPRITE.icon_bot_speech_mute;s.utils.isSvg(i)?(C=n.utils.createElementFromString(i,["header-button-icon"]),S.appendChild(C)):(y=n.utils.createImage(i,["header-button-img-icon"]),S.appendChild(y)),S.title=n._audioButtonOn?n.settings.i18n[a].audioResponseOn:n.settings.i18n[a].audioResponseOff};w(),S.onclick=function(){n._audioButtonOn=!n._audioButtonOn,w(),n.onAudioToggle(n._audioButtonOn)},r.appendChild(S)}if(!this.settings.embedded){var x=this.utils.createButton(["header-button","button-close"]);x.title=this.settings.i18n[a].close;_=null!=(e=this.settings.closeIcon)?e:c.SVG_SPRITE.icon_bot_collapse;if(s.utils.isSvg(_)){var E=this.utils.createElementFromString(_,["header-button-icon"]);x.appendChild(E)}else{var T=this.utils.createImage(_,["header-button-img-icon"]);x.appendChild(T)}x.onclick=this.closeWidgetPopup.bind(this),r.appendChild(x)}return i.appendChild(r),i},e.prototype._updateStatusMessage=function(t){if(this.settings.showConnectionStatus)switch(this._connectionStatus.className=this.utils.getCssClassWithPrefix("connection-status"),t){case a.CONNECTION_STATE.OPEN:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].connected,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connecting"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connected"));break;case a.CONNECTION_STATE.CLOSED:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].disconnected,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connecting"),this.utils.getCssClassWithPrefix("connected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("disconnected"));break;case a.CONNECTION_STATE.CLOSING:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].closing,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connected"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connecting"));break;case a.CONNECTION_STATE.CONNECTING:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].connecting,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connected"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connecting"))}},e}(r.Component);e.WidgetHeaderComponent=l},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e)||this;return i.settings=n,i.element=i._createElement(),i}return o(e,t),e.prototype.render=function(t){},e.prototype._createElement=function(){return this.utils.createDiv(["conversation"])},e}(n(7).Component);e.WidgetMainComponent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),o=n(28),s=n(33),r=n(35),a=n(1),c=n(36),l=n(37),h=function(){function t(){}return t.fromMessage=function(t,e,n,h,u,p){var d,g;switch(n.from?(d=a.MESSAGE_SIDE.LEFT,g=n.messagePayload):(d=a.MESSAGE_SIDE.RIGHT,g=n.messagePayload),g.type){case i.PAYLOAD_TYPE.TEXT:return new l.TextMessageComponent(t,e,g,d,n.date,h);case i.PAYLOAD_TYPE.ATTACHMENT:return new o.AttachmentMessageComponent(t,e,g,d,n.date,h,u,p);case i.PAYLOAD_TYPE.CARD:return new s.CardMessageComponent(t,e,g,d,n.date,h);case i.PAYLOAD_TYPE.LOCATION:return new r.LocationMessageComponent(t,e,g,d,n.date,h);case i.PAYLOAD_TYPE.RAW:return new c.RawMessageComponent(t,e,g,d,n.date,h);default:throw Error("Wrong message payload type:"+g.type)}},t.extractUtteranceText=function(t,e){var n=(t.from,t.messagePayload),o="";switch(n.type){case i.PAYLOAD_TYPE.ATTACHMENT:o=this._extractUtteranceAttachment(n,e);break;case i.PAYLOAD_TYPE.CARD:o=this._extractUtteranceCard(n,e);break;case i.PAYLOAD_TYPE.LOCATION:o=this._extractUtteranceLocation(n);break;case i.PAYLOAD_TYPE.RAW:o=this._extractUtteranceRaw(n);break;case i.PAYLOAD_TYPE.TEXT:o=this._extractUtteranceText(n);break;default:o=e.utteranceGeneric}return this.stripHTMLFromText(o)},t._getUtterance=function(t,e){var n;return(t.headerText?t.headerText+this.PAUSE:"")+(e?e+this.PAUSE:"")+this._parseActionsUtterance(t.actions)+this._parseActionsUtterance(t.globalActions)+(null!=(n=t.footerText)?n:"")},t._parseActionsUtterance=function(t){var e=this,n="";return t&&t.forEach((function(t){t.label&&(n=n.concat(t.label).concat(e.PAUSE))})),n},t._extractUtteranceAttachment=function(t,e){return this._getUtterance(t,e[t.type+"-"+t.attachment.type])},t._extractUtteranceCard=function(t,e){var n=this,i="";return t.cards&&t.cards.forEach((function(t,o){i=i.concat(e.card+" "+(o+1)).concat(n.PAUSE),t.title&&(i=i.concat(t.title).concat(n.PAUSE)),t.description&&(i=i.concat(t.description).concat(n.PAUSE)),t.actions&&(i=i.concat(n._parseActionsUtterance(t.actions)))})),this._getUtterance(t,i)},t._extractUtteranceLocation=function(t){return this._getUtterance(t,t.location.title?t.location.title+this.PAUSE:"")},t._extractUtteranceRaw=function(t){return this._getUtterance(t,t.payload)},t._extractUtteranceText=function(t){return this._getUtterance(t,t.text)},t.stripHTMLFromText=function(t){var e,n;return t=null===(n=t=null===(e=t)||void 0===e?void 0:e.replace(/<[^>]+>/g,""))||void 0===n?void 0:n.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(e)}))},t.PAUSE=";",t}();e.MessageComponentFactory=h},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(16),r=n(29),a=n(30),c=n(31),l=n(32),h=n(1),u=function(t){function e(n,i,o,r,a,c,l,u){var p=t.call(this,n,i,o,r,a,c)||this;p._date=a;var d=!1;return h.MESSAGE_SIDE.RIGHT!==r||s.ATTACHMENT_TYPE.FILE===o.attachment.type||u||(d=l(o.attachment.url)),p._attachment=e.fromPayload(n,i,o.attachment,r,d),p}return o(e,t),e.fromPayload=function(t,e,n,i,o){switch(n.type){case s.ATTACHMENT_TYPE.IMAGE:return new c.ImageAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.VIDEO:return new l.VideoAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.AUDIO:return new r.AudioAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.FILE:return new a.FileAttachmentComponent(t,e,n,i);default:throw Error("Payload contains wrong attachment type")}},e.prototype.render=function(e){return t.prototype.render.call(this)},e.prototype.getContent=function(){return this._attachment.render()},e}(h.MessageComponent);e.AttachmentMessageComponent=u},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){if(s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable){var t=this.utils.createAudio(this._url,"attachment-audio");return t.controls=!0,s.MESSAGE_SIDE.RIGHT===this.side&&t.setAttribute("controlsList","nodownload"),t.innerHTML='Your browser does not support embedded audio. However you can<a href="'+this._url+'">download it</a>.',t}return this.createMessageElement(this.settings.audioIcon,this.payload.fileName)},e}(n(9).AttachmentComponent);e.AudioAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o){var s=t.call(this,i,e)||this;return s.settings=n,s.payload=i,s.side=o,s._url=i.url,s}return o(e,t),e.prototype.render=function(){return s.MESSAGE_SIDE.RIGHT===this.side?this.createMessageElement(this.settings.fileIcon,this.payload.fileName):this.utils.createAnchor(this._url,this.payload.fileName,["attachment-file"])},e}(n(9).AttachmentComponent);e.FileAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){return s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable?this.utils.createImage(this._url,["attachment-image"],this.payload.fileName):this.createMessageElement(this.settings.imageIcon,this.payload.fileName)},e}(n(9).AttachmentComponent);e.ImageAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){if(s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable){if(this._url.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)){var t=this.utils.createSpan();return t.innerHTML=this.utils.linkify(this._url,{embeddedHTML:!0,embeddedVideo:this.settings.embeddedVideo}),t}(e=this.utils.createVideo(this._url,"attachment-video")).controls=!0;e.attributes;return s.MESSAGE_SIDE.RIGHT===this.side&&e.setAttribute("controlsList","nodownload"),e.innerHTML='Your browser does not support embedded video. However you can <a href="'+this._url+'">download it</a>.',e}var e;return e=this.createMessageElement(this.settings.videoIcon,this.payload.fileName)},e}(n(9).AttachmentComponent);e.VideoAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=n(34),a=n(8),c=function(t){function e(e,n,i,o,s,a){var c=t.call(this,e,n,i,o,s,a)||this;c.cards=[],c._layout=i.layout,c.date=s;for(var l=0,h=0,u=i.cards;h<u.length;h++){var p=u[h];l++,c.cards.push(new r.CardComponent(c.utils,c.settings,p,l))}return c}return o(e,t),e.prototype.render=function(){var t=this.utils.createDiv(["message","card-message-"+this._layout,this.side]);this._currentCard=0;var e=this.utils.createDiv(["message-wrapper"]);if(this.headerText){var n=this.utils.createDiv(["message-bubble","message-header"]);n.innerText=this.headerText,t.prepend(n)}var i=this.utils.createDiv(["card-message-content"]);if(this._cardsmsg=this.utils.createDiv(["card-message-cards"]),"horizontal"!==this._layout)for(var o=0,s=this.cards;o<s.length;o++){var r;(r=s[o]).onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(r.render())}else(r=this.cards[this._currentCard]).onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(r.render());if("horizontal"===this._layout&&this.cards.length>1&&this._cardsmsg.appendChild(this._getNextButton()),i.appendChild(this._cardsmsg),e.appendChild(i),t.appendChild(e),this.footerText){var a=this.utils.createDiv(["message-bubble","message-footer"]);a.innerText=this.footerText,t.appendChild(a)}return this.appendGlobalActions(t,this.actions),this.appendGlobalActions(t,this.globalActions),t},e.prototype.disableActions=function(e){t.prototype.disableActions.call(this,e);for(var n=0,i=this.cards;n<i.length;n++){i[n].disableActions(e)}},e.prototype.enableActions=function(){t.prototype.enableActions.call(this);for(var e=0,n=this.cards;e<n.length;e++){n[e].enableActions()}},e.prototype.nextCard=function(){this._currentCard++,this._cardsmsg.innerHTML="";var t=this.cards[this._currentCard];t.onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(this._getPreviousButton()),this._currentCard<this.cards.length-1&&this._cardsmsg.appendChild(this._getNextButton()),this._cardsmsg.appendChild(t.render())},e.prototype.previousCard=function(){this._currentCard--,this._cardsmsg.innerHTML="",0!==this._currentCard&&this._cardsmsg.appendChild(this._getPreviousButton());var t=this.cards[this._currentCard];t.onActionClick=this.handleOnActionClick.bind(this),this._currentCard<this.cards.length-1&&this._cardsmsg.appendChild(this._getNextButton()),this._cardsmsg.appendChild(t.render())},e.prototype._getNextButton=function(){if(!this._buttonNext){this._buttonNext=this.utils.createDiv(["round","next"]);var t=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_next);this._buttonNext.appendChild(t),this._buttonNext.onclick=this.nextCard.bind(this)}return this._buttonNext},e.prototype._getPreviousButton=function(){if(!this._buttonPrevious){this._buttonPrevious=this.utils.createDiv(["round","previous"]);var t=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_previous);this._buttonPrevious.appendChild(t),this._buttonPrevious.onclick=this.previousCard.bind(this)}return this._buttonPrevious},e}(s.MessageComponent);e.CardMessageComponent=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),o=function(){function t(t,e,n,o){if(this.utils=t,this.settings=e,this._actions=[],this._title=n.title,this._description=n.description,this._imageUrl=n.imageUrl,this._url=n.url,n.actions)for(var s=0,r=0,a=n.actions;r<a.length;r++){var c=a[r];s++,c.actionId="card"+o+"Action"+s;var l=i.ActionComponentFactory.fromActionPayload(t,c);l&&(l.onActionClick=this.handleOnActionClick.bind(this),this._actions.push(l))}}return t.prototype.handleOnActionClick=function(t){this.onActionClick&&this.onActionClick(t)},t.prototype.handleOnActionTrigger=function(t){var e=+t.match(/\d+/g)[1];return this._actions[e-1]},t.prototype.render=function(){var t=this._url?this.utils.createAnchor(this._url,"",["card"],this.settings.openLinksInNewWindow):this.utils.createDiv(["card"]),e=this.settings.locale;this._url&&(t.innerText=""),this._imageUrl&&t.appendChild(this.utils.createImage(this._imageUrl,["card-image"],this.settings.i18n[e].cardImagePlaceholder));var n=this.utils.createDiv(["card-content"]),i=this.utils.createDiv(["card-title"]);if(i.innerText=this._title,n.appendChild(i),this._description){var o=this.utils.createDiv(["card-description"]);o.innerText=this._description,n.appendChild(o)}if(t.appendChild(n),this._actions.length>0){for(var s=this.utils.createDiv(this.settings.displayActionsAsPills?["card-actions","card-actions-pill"]:["card-actions"]),r=0,a=this._actions;r<a.length;r++){var c=a[r];s.appendChild(c.render())}t.appendChild(s)}return t},t.prototype.disableActions=function(t){if("postback"!==this.settings.disablePastActions||t)for(var e=0,n=this._actions;e<n.length;e++){(s=n[e]).disable()}else for(var i=0,o=this._actions;i<o.length;i++){var s;"postback"!==(s=o[i]).getActionType()&&"location"!==s.getActionType()||s.disable()}},t.prototype.enableActions=function(){for(var t=0,e=this._actions;t<e.length;t++){e[t].enable()}},t}();e.CardComponent=o},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(10),r=n(15),a=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._title=i.location.title,a._url=i.location.url,a._longitude=i.location.longitude,a._latitude=i.location.latitude,a._date=s,a}return o(e,t),e.prototype.render=function(){if(0===this.actions.length){var e={actionId:"locationAction1",label:"Open Map",type:s.ACTION_TYPE.URL,url:this._url||"http://www.google.com/maps?z=12&t=m&q=loc:"+this._latitude+"+"+this._longitude};this.actions.push(new r.UrlActionComponent(this.utils,e,this.settings.openLinksInNewWindow))}return t.prototype.render.call(this)},e.prototype.getContent=function(){var t=this.utils.createSpan();return this._title?t.innerText=this._title:t.innerText=this._latitude.toFixed(6)+", "+this._longitude.toFixed(6),t},e}(n(1).MessageComponent);e.LocationMessageComponent=a},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._date=s,a._payload=JSON.stringify(i.payload),a}return o(e,t),e.prototype.getContent=function(){var t=this.utils.createSpan();return t.innerText=this._payload,t},e}(n(1).MessageComponent);e.RawMessageComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._text=i.text,a._date=s,a}return o(e,t),e.prototype.getContent=function(){var t=this.utils.createSpan();return t.innerHTML=this.utils.linkify(this._text,{embeddedHTML:this.side===s.MESSAGE_SIDE.LEFT,embeddedVideo:!0}),t},e}(s.MessageComponent);e.TextMessageComponent=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),o=n(2),s=function(){function t(t,e,n){this.side=t,this.utils=e,this.settings=n}return t.prototype.render=function(){var t,e;this._element=this.utils.createDiv(["message",this.side]);var n=null!=(t=this.settings.chatBubbleIcon)?t:i.SVG_SPRITE.icon_bot_message_bubble;return(e=o.utils.isSvg(n)?this.utils.createElementFromString(n):this.utils.createImage(n)).style.height=this.settings.chatBubbleIconHeight||e.style.height,e.style.width=this.settings.chatBubbleIconWidth||e.style.width,this._element.appendChild(e),this._element},t.prototype.remove=function(){this._element.remove()},t}();e.ChatBubbleComponent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(40),o=function(){function t(t,e,n){this.text=t,this.side=e,this.utils=n}return t.prototype.render=function(){this._element=this.utils.createDiv(["loading-message",this.side]);var t=this.utils.createDiv(["message-bubble"]),e=this.utils.createDiv(["message-content","loading-icon"]);e.appendChild(new i.SpinnerComponent(this.utils).render());var n=this.utils.createDiv(["message-text"]),o=this.utils.createSpan();return o.innerHTML=this.text,n.appendChild(o),e.appendChild(n),t.appendChild(e),this._element.appendChild(t),this._element},t.prototype.remove=function(){this._element.remove()},t}();e.LoadingMessageComponent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.utils=t}return t.prototype.render=function(){var t=this.utils.createDiv(["spinner"]);return t.innerHTML='<svg viewBox="0 0 64 64"><circle transform="translate(32,32)" r="26"></circle></svg>',t},t}();e.SpinnerComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){this.text=t,this.side=e,this.utils=n}return t.prototype.render=function(t){this._element=this.utils.createDiv(["message",this.side]);var e=this.utils.createDiv(["message-bubble"]),n=this.utils.createDiv(["message-content"]);t&&n.classList.add(this.utils.getCssClassWithPrefix("message-with-icon"));var i=this.utils.createDiv(["error-icon"]);i.appendChild(this.utils.createImage(t));var o=this.utils.createDiv(["message-text"]),s=this.utils.createSpan();return s.innerHTML=this.text,o.appendChild(s),n.appendChild(i),n.appendChild(o),e.appendChild(n),this._element.appendChild(e),this._element},t}();e.MessageStringComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){this.message=t,this.utils=e,this.image=n,this._element=e.createDiv(["status-message-container"]);var i=e.createDiv(["status-message-wrapper"]);if(n){var o=e.createImage(n,["status-image"]);i.appendChild(o)}var s=e.createDiv(["status-message"]);s.textContent=t,i.appendChild(s),this._element.appendChild(i)}return t.prototype.remove=function(){this._element.remove()},t.prototype.render=function(){return this._element},t}();e.StatusComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){if(!speechSynthesis)throw new Error("SpeechSynthesis API not available on your device.");this._setDefaultVoice(),window.addEventListener("beforeunload",(function(t){speechSynthesis.cancel(),delete t.returnValue}))}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.speak=function(t){if(speechSynthesis){var e=new SpeechSynthesisUtterance;e.voice=this.botVoice,e.text=t,e.rate=1,speechSynthesis.paused&&speechSynthesis.resume(),speechSynthesis.speak(e)}},t.prototype.cancel=function(){var t;(null===(t=speechSynthesis)||void 0===t?void 0:t.speaking)&&speechSynthesis.cancel()},t.prototype.pause=function(){var t;(null===(t=speechSynthesis)||void 0===t?void 0:t.speaking)&&speechSynthesis.pause()},t.prototype.resume=function(){speechSynthesis&&speechSynthesis.resume()},t.prototype.setVoice=function(t){var e=this,n=this.botVoice;this._getVoices().then((function(i){var o=function(t,e){return(t=t.toLowerCase())===(e=e.toLowerCase())};e.botVoice=void 0,t.forEach((function(t){t.lang=t.lang||"",t.name=t.name||""})),t.every((function(t){if(t.lang.length>0&&t.name.length>0)for(var n=0,s=i;n<s.length;n++){var r=s[n];if(o(r.name,t.name)&&o(r.lang,t.lang)){e.botVoice=r;break}}return void 0===e.botVoice})),e.botVoice||t.every((function(t){for(var n=0,s=i;n<s.length;n++){var r=s[n];if(o(r.lang,t.lang)){e.botVoice=r;break}}return void 0===e.botVoice})),e.botVoice||(e.botVoice=n)}))},t.prototype._setDefaultVoice=function(){var t=this;speechSynthesis&&this._getVoices().then((function(e){var n,i;(null===(n=navigator)||void 0===n?void 0:n.language)&&(t.botVoice=e.filter((function(t){return t.lang===navigator.language}))[0]),t.botVoice||(t.botVoice=null===(i=e)||void 0===i?void 0:i.filter((function(t){return t.default}))[0]),t.botVoice||(t.botVoice=e[0])}))},t.prototype._getVoices=function(){var t=function(t){return Array.isArray(t)||(t=t._list),t};return new Promise((function(e){var n=speechSynthesis.getVoices();n.length?e(t(n)):speechSynthesis.addEventListener("voiceschanged",(function(){n=speechSynthesis.getVoices(),e(t(n))}))}))},t}();e.SpeechSynthesisService=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.settings=t}return t.prototype.clone=function(t){return JSON.parse(JSON.stringify(t))},t.prototype.linkify=function(t,e){var n,i,o,s,r,a,c=this;return(e=e||{}).embeddedHTML||(t=null===(i=t=null===(n=t)||void 0===n?void 0:n.replace(/</g,"&lt;"))||void 0===i?void 0:i.replace(/>/g,"&gt;")),r=/^(?!href=['"])(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,a=/(^|[^\/])(www\.[\S][-A-Z0-9+&@#\/%=.~_|]+(\b|$))/gim,null===(s=null===(o=t)||void 0===o?void 0:o.replace(r,(function(t,n,i){var o=e.embeddedVideo?c.getYouTubeVideoId(n):null;return o?'<iframe width="100%" src="https://www.youtube.com/embed/'+o+'" frameborder="0" allowfullscreen></iframe>':'<a href="'+n+'" target="_blank">'+n+"</a>"})))||void 0===s?void 0:s.replace(a,(function(t,n,i){var o=e.embeddedVideo?c.getYouTubeVideoId("https://"+i):null;return o?'<iframe width="100%" src="https://www.youtube.com/embed/'+o+'" frameborder="0" allowfullscreen></iframe>':n+'<a href="https://'+i+'" target="_blank">'+i+"</a>"}))},t.prototype.getYouTubeVideoId=function(t){var e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return e&&11===e[2].length?e[2]:null},t.prototype.getCssClassWithPrefix=function(t){return this.settings.name+"-"+t},t.prototype.createButton=function(t){var e=document.createElement("button");if(e.type="button",t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createAnchor=function(t,e,n,i){void 0===i&&(i=!1);var o=document.createElement("a");if(t&&(o.href=t),i?o.onclick=function(){return window.open(t,"","height=450px,width=800px,menubar,toolbar,personalbar,status,resizable,noopener,noreferrer"),!1}:o.target="_blank",e?o.innerText=e:t&&(o.innerText=t),n)for(var s=0,r=n;s<r.length;s++){var a=r[s];o.classList.add(this.getCssClassWithPrefix(a))}return o},t.prototype.createDiv=function(t){var e=document.createElement("div");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createElementFromString=function(t,e){var n=this,i=document.createElement("div");return i.innerHTML=t.trim(),e&&e.forEach((function(t){return i.firstElementChild.classList.add(n.getCssClassWithPrefix(t))})),i.firstElementChild},t.prototype.createParagraph=function(t){var e=document.createElement("p");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createSpan=function(t){var e=document.createElement("span");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createInput=function(t,e){var n=document.createElement("input");if(t)for(var i=0,o=t;i<o.length;i++){var s=o[i];n.classList.add(this.getCssClassWithPrefix(s))}return e&&(n.type=e),n},t.prototype.createTextArea=function(t){var e=document.createElement("TEXTAREA");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createImage=function(t,e,n){var i=document.createElement("img");if(t&&(i.src=t),e)for(var o=0,s=e;o<s.length;o++){var r=s[o];i.classList.add(this.getCssClassWithPrefix(r))}return n&&(i.alt=n),i},t.prototype.createAudio=function(t,e,n){var i=document.createElement("audio");return t&&(i.src=t),i.autoplay=void 0!==n&&n,e&&i.classList.add(this.getCssClassWithPrefix(e)),i},t.prototype.createVideo=function(t,e,n){var i=document.createElement("video");return t&&(i.src=t),i.autoplay=void 0!==n&&n,e&&i.classList.add(this.getCssClassWithPrefix(e)),i},t.prototype.createWrappedSvg=function(t,e){var n=this.createDiv(e);return n.appendChild(t),n},t.prototype.createHTML=function(t){var e=this.createDiv();return e.innerHTML=t,e},t.prototype.createStyle=function(t){var e=document.createElement("style");return e.type="text/css",e.appendChild(document.createTextNode(t)),e},t.prototype.addStyleToHTML=function(t){window&&document.head.appendChild(t)},t}();e.Utils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(46),o=function(){function t(t,e){this.utils=t,this.settings=e}return t.prototype.addStyle=function(e){t.STYLE=t.STYLE+e},t.prototype.setWidgetCssClasses=function(){var t,e,n,i,o,s,r=[],a=[],c=[],l=[],h=[],u=[],p=[],d=[],g=[],f=[],m=[],_=[],v=function(t,e){var n,i="";return(null===(n=e)||void 0===n?void 0:n.length)>0&&(i="."+t+" {\n",e.forEach((function(t){i+="  "+t+";\n"})),i+="}\n\n"),i},b=function(t){return v(t,["display: none"])},y="",C="@media screen and (min-width: 426px) {\n";if(this.settings.enableHeadless)return y+=b("wrapper"),y+=b("widget"),y+=b("button"),y+=b("notification-badge");if(this.settings.colors){var S=this.settings.colors;if(S.botMessageBackground&&p.push("background: "+S.botMessageBackground),S.botText&&p.push("color: "+S.botText),S.branding){var w=["outline-color: "+S.branding];y+=v("button:focus",w),y+=v("footer-button:focus",w)}S.cardBackground&&g.push("background: "+S.cardBackground),S.conversationBackground&&u.push("background: "+S.conversationBackground),S.footerBackground&&(m.push("background: "+S.footerBackground),_.push("background: "+S.footerBackground)),S.headerBackground?(l.push("background: "+S.headerBackground),h.push("background: "+S.headerBackground)):(l.push("background: "+S.branding),h.push("background: "+S.branding)),S.notificationBadgeBackground&&c.push("background: "+S.notificationBadgeBackground),S.notificationBadgeText&&c.push("color: "+S.notificationBadgeText),S.text&&r.push("color: "+S.text),S.textLight&&f.push("color: "+S.textLight),S.userMessageBackground&&d.push("background: "+S.userMessageBackground),S.userText&&d.push("color: "+S.userText)}return this.settings.font&&r.push("font: "+this.settings.font),(null===(t=this.settings.position)||void 0===t?void 0:t.bottom)&&(r.push("bottom: "+this.settings.position.bottom),a.push("bottom: -"+this.settings.position.bottom)),(null===(e=this.settings.position)||void 0===e?void 0:e.right)&&(r.push("right: "+this.settings.position.right),a.push("right: -"+this.settings.position.right)),this.settings.badgePosition.bottom&&c.push("bottom: "+this.settings.badgePosition.bottom),this.settings.badgePosition.left&&c.push("left: "+this.settings.badgePosition.left),this.settings.badgePosition.right&&c.push("right: "+this.settings.badgePosition.right),this.settings.badgePosition.top&&c.push("top: "+this.settings.badgePosition.top),y+=v("wrapper",r),y+=v("widget",a),y+=v("button",[]),y+=v("notification-badge",c),y+=v("header",l),y+=v("header-button",h),y+=v("conversation",u),y+=v("left .message-bubble, .left .message-header, .left .message-footer",p),y+=v("right .message-bubble",d),y+=v("card",g),y+=v("card-description",f),y+=v("footer",m),y+=v("user-input",_),r.splice(0,r.length),a.splice(0,a.length),(null===(n=this.settings.position)||void 0===n?void 0:n.bottom)&&(r.push("bottom: "+this.settings.position.bottom),a.push("bottom: 0"),a.push("max-height: calc(100vh - "+this.settings.position.bottom+" - 60px)")),(null===(i=this.settings.position)||void 0===i?void 0:i.left)&&r.push("left: "+this.settings.position.left),(null===(o=this.settings.position)||void 0===o?void 0:o.right)&&(r.push("right: "+this.settings.position.right),a.push("right: 0"),a.push("max-width: calc(100vw - "+this.settings.position.right+")")),(null===(s=this.settings.position)||void 0===s?void 0:s.top)&&r.push("top: "+this.settings.position.top),this.settings.height&&a.push("height: "+this.settings.height),this.settings.width&&a.push("width: "+this.settings.width),C+=v("wrapper",r),C+=v("widget",a),y+(C+="}\n")},t.prototype.render=function(){return this.utils.createStyle(t.STYLE.replace(/(\.)([a-zA-Z_-]+)/gi,"$1"+this.settings.name+"-$2"))},t.STYLE=i.css,t}();e.StyleComponent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(47),o=n(49),s=n(51),r=n(53),a=n(55),c=n(57),l=n(59),h=n(61),u=n(63),p=""+i+r+o+s+a+c+l+h+n(65)+u+n(67)+n(69)+n(71);e.css=p},function(t,e,n){var i=n(48);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,"/* wrapper base state */\n.wrapper {\n    box-sizing: border-box;\n    height: 0;\n    position: fixed;\n    text-transform: none;\n    width: 0;\n    z-index: 10000;\n    transition: all 0.25s ease-in-out;\n}\n\n/* button base state */\n.button {\n    background-position: center center;\n    background-repeat: no-repeat;\n    border: none;\n    border-radius: 50%;\n    bottom: 0;\n    box-shadow: 0 -1px 5px 0 rgba(0, 0, 0, 0.35);\n    cursor: pointer;\n    overflow: visible;\n    padding: 0;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    z-index: 10000;\n    transition: height 0.25s ease-out, width 0.25s ease-out;\n}\n\n.expanded .button {\n    -webkit-animation: scale-out-center 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n            animation: scale-out-center 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n}\n\n.collapsed .button {\n    display: flex;\n    -webkit-animation: scale-in-center 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n            animation: scale-in-center 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n}\n\n.button img {\n    max-height: 100%;\n    max-width: 100%;\n}\n\n.notification-badge {\n    align-items: center;\n    background: rgb(230, 8, 27);\n    background-size: 10px;\n    border-radius: 45%;\n    color: #fff;\n    display: flex;\n    height: 24px;\n    justify-content: center;\n    position: absolute;\n    text-align: center;\n    width: 32px;\n}\n\n/* Widget base state */\n.widget {\n    background: #ffffff;\n    box-shadow: -4px 2px 21px 0 rgba(112, 112, 112, 0.50);\n    display: flex;\n    flex-direction: column;\n    margin: 0;\n    position: absolute;\n    text-decoration: none;\n    text-transform: none;\n    z-index: 10000;\n}\n\n.expanded .widget {\n    -webkit-animation: scale-in-br 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n            animation: scale-in-br 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n}\n\n.collapsed .widget {\n    -webkit-animation: scale-out-br 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n\t        animation: scale-out-br 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n}\n\n.none {\n    display: none;\n}\n\n.conversation-pane {\n    display: flex;\n    flex: 1 1 auto;\n    flex-direction: column;\n}\n\n.conversation-container {\n    padding: 10px 10px 0 10px;\n}\n\n.empty-conversation-div {\n    display: flex;\n    flex: auto;\n}\n\n.chat-message-date {\n    font-size: 10px;\n    padding: 6px 0;\n}\n\n.embed-sticky-top {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n.embed-scroll-top {\n    padding-top: 5px;\n    padding-bottom: 10px;\n}\n\n.embed-scroll-bottom {\n    padding-top: 10px;\n    padding-bottom: 5px;\n}\n\n.embed-sticky-bottom {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n/* Chat responsive layouts */\n\n/* Mobile layout */\n.wrapper {\n    bottom: 20px;\n    right: 10px;\n}\n\n.button {\n    height: 48px;\n    width: 48px;\n}\n\n.button-icon {\n    max-height: 48px;\n    max-width: 48px;\n}\n\n.widget {\n    bottom: -20px;\n    height: 85vh;\n    max-height: calc(100vh - 60px);\n    max-width: 100vw;\n    right: -10px;\n    width: 100vw;\n    transition: all 0.25s ease-in-out;\n}\n\n/* Large mobile and tablet layout */\n@media screen and (min-width: 426px) {\n    .widget {\n        bottom: 0;\n        height: 85vh;\n        /* 20px compensation for bottom position of wrapper */\n        max-height: calc(100vh - 20px - 60px);\n        /* 10px compensation for right position of wrapper and next 10px for balanced look */\n        max-width: calc(100vw - 10px - 10px);\n        min-width: 300px;\n        right: 0;\n        width: 300px;\n    }\n}\n\n/* Desktop layout */\n@media screen and (min-width: 769px) {\n    .wrapper {\n        bottom: 20px;\n        right: 20px;\n    }\n\n    .button {\n        height: 64px;\n        width: 64px;\n    }\n\n    .button-icon {\n        max-height: 64px;\n        max-width: 64px;\n    }\n\n    .widget {\n        height: 70vh;\n        /* 20px compensation for bottom position of wrapper */\n        max-height: calc(100vh - 20px - 60px);\n        max-width: 512px;\n        width: 30vw;\n    }\n}\n\n/* Chat button entrance */\n@-webkit-keyframes scale-in-center {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n    }\n    100% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n    }\n}\n\n@keyframes scale-in-center {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n    }\n    100% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n    }\n}\n\n/* Chat button exit */\n@-webkit-keyframes scale-out-center {\n    0% {\n        display: flex;\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n    }\n    100% {\n        display: none;\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n    }\n}\n\n@keyframes scale-out-center {\n    0% {\n        display: flex;\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n    }\n    100% {\n        display: none;\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n    }\n}\n\n/* Chat widget entrance */\n@-webkit-keyframes scale-in-br {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    100% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n}\n\n@keyframes scale-in-br {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    100% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n}\n\n/* Chat widget exit */\n@-webkit-keyframes scale-out-br {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    99% {\n        opacity: 1;\n        -webkit-transform: scale(0.01);\n                transform: scale(0.01);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    100% {\n        display: none;\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n}\n\n@keyframes scale-out-br {\n    0% {\n        opacity: 1;\n        -webkit-transform: scale(1);\n                transform: scale(1);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    99% {\n        opacity: 1;\n        -webkit-transform: scale(0.01);\n                transform: scale(0.01);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n    100% {\n        display: none;\n        opacity: 1;\n        -webkit-transform: scale(0);\n                transform: scale(0);\n        -webkit-transform-origin: 100% 100%;\n                transform-origin: 100% 100%;\n    }\n}\n",""]),t.exports=e},function(t,e,n){var i=n(50);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".footer {\n    align-items: center;\n    background-color: #ffffff;\n    border-top: 1px solid #dadada;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    max-height: 78px;\n    padding: 12px 10px 12px 2px;\n    position: relative;\n}\n\n.footer-button {\n    align-items: center;\n    background-color: transparent;\n    border: none;\n    cursor: pointer;\n    display: inline-block;\n    -webkit-tap-highlight-color: transparent;\n    justify-content: center;\n    max-height: 24px;\n    max-width: 24px;\n    overflow: hidden;\n    padding: 0;\n    text-shadow: none;\n}\n\n.footer-button-icon {\n    background-size: 100%;\n    background-position: center;\n    height: 100%;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n}\n\n.footer-button-svg-icon {\n    height: 24px;\n    fill: #878C90;\n    width: 24px;\n}\n\n.footer-button:disabled .footer-button-svg-icon,\n.footer-button:disabled .footer-button-svg-icon:active,\n.footer-button:disabled .footer-button-svg-icon:hover {\n    fill: #cbcccd;\n}\n\n.button-upload {\n    height: 24px;\n    width: 24px;\n    margin-left: 8px;\n}\n\n.button-send {\n    height: 24px;\n    width: 24px;\n}\n\n.button-speech-active {\n    animation: mic-toggle 300ms ease 0s infinite normal none running;\n}\n\n@keyframes mic-toggle {\n    from {\n        fill: #ff8a80;\n    }\n\n    to {\n        fill: #d50000;\n    }\n}\n\n.user-input {\n    border: none;\n    box-sizing: border-box;\n    color: #333333;\n    flex: 1;\n    height: 24px;\n    margin-left: 8px;\n    margin-right: 8px;\n    max-height: 100%;\n    outline: none;\n    padding: 2px;\n    resize: none;\n}\n\n.user-input::placeholder {\n    padding: 5px 2;\n    color: #707070;\n}\n\n.user-input.disabled {\n    color: #737373;\n}\n\n.user-input.disabled::placeholder {\n    color: #cbcccd;\n}\n\n.autocomplete-items {\n    border: 1px solid #bababa;\n    bottom: 100%;\n    left: 0;\n    margin: 0 32px;\n    position: absolute;\n    right: 0;\n    z-index: 1;\n    -webkit-animation: popup-suggestion .150s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n    animation: popup-suggestion .150s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n}\n\n@-webkit-keyframes popup-suggestion {\n    0% {\n        box-shadow: 0 0 0 0 rgba(0, 0, 0, 0), 0 0 0 0 rgba(0, 0, 0, 0);\n        -webkit-box-shadow: inset 0 0 0 0 rgba(0, 0, 0, 0);\n        box-shadow: inset 0 0 0 0 rgba(0, 0, 0, 0);\n        -webkit-transform: scaleY(0.4);\n        transform: scaleY(0.4);\n        -webkit-transform-origin: 0% 100%;\n        transform-origin: 0% 100%;\n    }\n\n    100% {\n        box-shadow: 0 -12px 20px -12px rgba(0, 0, 0, 0.35);\n        -webkit-transform: scaleY(1);\n        transform: scaleY(1);\n        -webkit-transform-origin: 0% 100%;\n        transform-origin: 0% 100%;\n    }\n}\n\n@keyframes popup-suggestion {\n    0% {\n        box-shadow: 0 0 0 0 rgba(0, 0, 0, 0), 0 0 0 0 rgba(0, 0, 0, 0);\n        -webkit-transform: scaleY(0.4);\n        transform: scaleY(0.4);\n        -webkit-transform-origin: 0% 100%;\n        transform-origin: 0% 100%;\n    }\n\n    100% {\n        box-shadow: 0 -12px 15px -12px rgba(0, 0, 0, 0.35);\n        -webkit-transform: scaleY(1);\n        transform: scaleY(1);\n        -webkit-transform-origin: 0% 100%;\n        transform-origin: 0% 100%;\n    }\n}\n\n.autocomplete-items div {\n    background-color: #fff;\n    cursor: pointer;\n    padding: 10px;\n}\n\n.autocomplete-items strong {\n    font-weight: 700;\n}\n\n.autocomplete-items div:hover {\n    background-color: #e9e9e9;\n}\n\n.autocomplete-items .autocomplete-active {\n    background-color: #85bbe7;\n}\n\n.autocomplete-items .autocomplete-active:hover {\n    background-color: #85bbe7;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(52);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".header {\n    align-items: center;\n    box-sizing: border-box;\n    color: #ffffff;\n    display: flex;\n    flex-direction: row;\n    height: 48px;\n    padding-left: 10px;\n    padding-right: 8px;\n}\n\n.logo {\n    flex: 0;\n    height: 24px;\n    max-height: 32px;\n    max-width: 32px;\n    min-height: 16px;\n    width: 24px;\n}\n\n.header-info-wrapper {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    margin: 0 8px;\n    min-width: 0;\n}\n\n.title {\n    color: #ffffff;\n    font-size: 18px;\n    justify-content: center;\n    max-width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.subtitle {\n    color: #ffffff;\n    font-size: 14px;\n    justify-content: center;\n    max-width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.connection-status {\n    font-weight: bold;\n    font-size: 10px;\n    justify-content: center;\n    text-transform: uppercase;\n}\n\n.header-custom-element {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    word-break: break-all;\n}\n\n.header-actions {\n    display: flex;\n    flex: 1;\n    justify-content: flex-end;\n}\n\n.header-button {\n    align-items: center;\n    border: none;\n    border-radius: 2px;\n    display: flex;\n    height: 32px;\n    justify-content: center;\n    margin-left: 8px;\n    max-height: 32px;\n    max-width: 32px;\n    padding: 4px;\n    width: 32px;\n}\n\n.header-button svg {\n    fill: #ffffff;\n}\n\n.header-button:hover {\n    filter: brightness(1.2);\n}\n\n.header-button:active {\n    filter: brightness(0.875);\n}\n\n.header-button-icon {\n    height: 16px;\n    width: 16px;\n}\n\n.header-button-img-icon {\n    max-height: 100%;\n    max-width: 100%;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(54);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,'.conversation {\n    background: #ffffff;\n    box-sizing: border-box;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-flex: 1;\n    -ms-flex: 1;\n    flex: 1;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -ms-flex-direction: column;\n    flex-direction: column;\n    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;\n    overflow: auto;\n    scroll-behavior: smooth;\n    width: 100%;\n}\n',""]),t.exports=e},function(t,e,n){var i=n(56);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".message-actions .action-postback {\n    align-items: center;\n    background: #0099ff;\n    border-bottom: 1px solid #e6e5eb;\n    border-radius: 20px;\n    color: #fff;\n    cursor: pointer;\n    display: flex;\n    justify-content: center;\n    padding: 10px;\n    margin: 5px 10px;\n    text-decoration: none;\n}\n\n.message-actions a.action-postback:hover {\n    background: #005c99;\n}\n\n.message-actions a.action-postback:focus, .message-actions a.action-postback:active {\n    background: #004d80;\n}\n\n.message-actions a.action-postback.disabled {\n    background: #f8f8f8;\n    color: #737373;\n}\n\n.message-global-actions {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n}\n\n.right .message-global-actions {\n    margin-left: 25px;\n}\n\n.left .message-global-actions {\n    margin-right: 25px;\n}\n\n.message-global-actions a {\n    border: 1px solid #4A90E2;\n    border-radius: 20px;\n    color: #4A90E2;\n    cursor: pointer;\n    display: inline-block;\n    margin-top: 10px;\n    padding: 8px 10px;\n    text-decoration: none;\n}\n\n.message-global-actions a:hover {\n    background: #4A90E2;\n    color: #fff;\n}\n\n.message-global-actions a:focus, .message-global-actions a:active {\n    background: #004d80;\n    color: #fff;\n}\n\n.message-global-actions a.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n}\n\n.action-image {\n    max-height: 24px;\n    max-width: 24px;\n    margin-left: 4px;\n    margin-right: 4px;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(58);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".attachment-image,\n.attachment-video{width: 100%;}\n.attachment-audio{width: 190px;}/* TODO: set by javascript */\n\n.attachment-message {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n\n.attachment-icon {\n    width: 32px;\n    height: 32px;\n    overflow: hidden;\n    margin-right: 5px;\n    justify-content: center;\n    background-color: transparent;\n    background: no-repeat center center;\n    border: none;\n    align-items: center;\n}\n\n.attachment-fileName {\n    margin: auto 0;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(60);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".card {\n    background: #fff;\n    box-sizing: border-box;\n    border: 1px solid rgba(0, 0, 0, 0.12);\n    border-radius: 20px;\n    display: block;\n    margin-bottom: 10px;\n    overflow: hidden;\n    padding: 10px 15px 10px 15px;\n    white-space: pre-wrap;\n}\n\n.card:last-of-type {\n    margin-bottom: 0;\n}\n\n.card-image {\n    height: 275px;\n    max-width: 100%;\n    width: 375px;\n}\n\n.card-title {\n    font-weight: 400;\n    padding: 5px 0;\n    max-width: 100%;\n    white-space: pre-wrap;\n}\n\n.card-description {\n    font-weight: 400;\n    max-width: 100%;\n    padding: 5px 0;\n    text-overflow: ellipsis;\n    width: 375px;\n    white-space: pre-wrap;\n}\n\n.card .card-actions a {\n    align-items: center;\n    border: 1px solid #e6e5eb;\n    border-radius: 20px;\n    color: #4a90e2;\n    cursor: pointer;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    padding: 8px 10px;\n    margin-bottom: 5px;\n}\n\n.card .card-actions-pill {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n}\n\n.card .card-actions a:last-of-type {\n    margin-bottom: 0;\n}\n\n.card .card-actions a:hover {\n    background: #eaeaea;\n    color: #277adc;\n}\n\n.card .card-actions a.disabled {\n    color: #737373;\n    background: #ffffff;\n}\n\n.card .card-actions.card-actions-pill a {\n    border: 1px solid #4A90E2;\n    margin-top: 10px;\n    margin-bottom: 0;\n    text-decoration: none;\n}\n\n.card .card-actions.card-actions-pill a:hover {\n    background: #4A90E2;\n    color: #fff;\n}\n\n.card .card-actions.card-actions-pill a:active {\n    background: #004d80;\n    color: #fff;\n}\n\n.card .card-actions.card-actions-pill a.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n}\n\n.card-message-content {\n    max-width: 100%;\n    padding-right: 15px;\n    white-space: pre-wrap;\n}\n\n.card-message-cards {\n    max-width: 100%;\n    padding-right: 10px;\n}\n\n.card-message-horizontal .card-message-cards {\n    position: relative;\n    -ms-flex-line-pack: center;\n    align-content: center;\n    white-space: pre-wrap;\n    display: inline-block;\n    width: 100%;\n}\n\n.card-message-horizontal .card {\n    width: 100%;\n    display: block;\n    white-space: pre-wrap;\n    padding: 8px;\n    margin: 0;\n}\n\n.card-message-vertical .card {\n    border-radius: 20px;\n}\n\n.card-message-vertical .message-wrapper {\n    flex-direction: column;\n}\n\n.round {\n    align-items: center;\n    background: #eaeaea;\n    border-radius: 50%;\n    -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    color: #333333;\n    cursor: pointer;\n    display: flex;\n    height: 30px;\n    justify-content: center;\n    margin: 5px;\n    padding: 5px;\n    position: absolute;\n    text-align: center;\n    top: calc(50% - 15px);\n    width: 30px;\n    z-index: 1;\n}\n\n.round svg {\n    fill: #333333;\n}\n\n.round:hover {\n    background: #4a90e2;\n    color: #ffffff;\n}\n\n.round:hover svg {\n    fill: #ffffff;\n}\n\n.previous {\n    left: -10px;\n}\n\n.next {\n    right: -10px;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(62);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".loading-message {\n    margin-bottom: 20px;\n}\n\n.loading-icon {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(64);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".spinner{\n    position: relative;\n    display: inline-block;\n    width: 28px;\n    height: 28px;\n    margin-right: 5px;\n}\n.spinner svg{\n    animation-duration: 750ms;\n    -webkit-animation: spinner-rotate 1s linear infinite;\n    animation: spinner-rotate 1s linear infinite;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    -webkit-transform: translateZ(0);\n    transform: translateZ(0);\n}\n.spinner circle{\n    stroke: #387ef5;\n    fill: transparent;\n    stroke-width: 4px;\n    stroke-dasharray: 128px;\n    stroke-dashoffset: 82px;\n}\n\n@-webkit-keyframes spinner-rotate {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}\n@keyframes spinner-rotate {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}",""]),t.exports=e},function(t,e,n){var i=n(66);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".message-with-icon {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n\n.error-icon {\n    margin-right: 5px;\n    max-width: 24px;\n    max-height: 24px;\n}\n\n.message-text {\n    margin: auto 0;\n    white-space: pre-wrap;\n    word-break: break-all;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(68);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".message {\n    margin-bottom: 20px;\n    -webkit-hyphens: auto;\n    -ms-hyphens: auto;\n    -moz-hyphens: auto;\n    hyphens: auto;\n}\n\n.left {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-start;\n}\n\n.right {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-end;\n}\n\n.message-wrapper {\n    display: flex;\n    max-width: 100%;\n}\n\n.left .message-wrapper {\n    flex-direction: row;\n}\n\n.right .message-wrapper {\n    flex-direction: row-reverse;\n}\n\n.icon-wrapper {\n    align-self: flex-end;\n    padding: 5px;\n}\n\n.message-icon {\n    max-width: 48px;\n    max-height: 48px;\n}\n\n.content-wrapper {\n    max-width: 100%;\n    overflow-x: auto;\n}\n\n/*------------*/\n\n.message-profile-pic {\n    padding: 2px;\n    display: inline-block;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background-color: rgba(20, 0, 0, .12);\n    position: absolute;\n}\n\n.left .message-profile-pic {\n    bottom: 6px;\n    left: 6px;\n}\n\n.right .message-profile-pic {\n    bottom: 6px;\n    right: 6px;\n}\n\n/*------------*/\n\n.message-bubble {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    margin: 0;\n    max-width: 325px;\n    padding: 15px;\n    position: relative;\n}\n\n.message-content {\n    overflow: hidden;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n}\n\n.right .message-bubble {\n    margin-left: 25px;\n    border-radius: 20px 20px 0 20px;\n}\n\n.left .message-bubble {\n    margin-right: 25px;\n    border-radius: 20px 20px 20px 0;\n}\n\n.left .message-header {\n    border-radius: 20px 20px 0 0;\n    margin-bottom: 10px;\n}\n\n.left .message-footer {\n    border-radius: 0 0 20px 0;\n    margin-top: 10px;\n}\n\n.left .has-header {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n\n.left .has-footer {\n    border-bottom-right-radius: 0;\n}\n\n/*------------*/\n\n.attachment-image, .attachment-video {\n    width: 100%;\n}\n\n.attachment-audio {\n    width: 190px;\n}\n\n/* TODO: set by javascript */\n\n/* Styling of Download Button */\n/* .chat-box-download-btn {\n    float: right;\n    margin: 10px 10px;\n} */\n",""]),t.exports=e},function(t,e,n){var i=n(70);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,".status-message-container {\n    display: flex;\n    flex-direction: column;\n}\n\n.status-message-wrapper {\n    align-self: center;\n    align-items: center;\n    display: flex;\n    flex: 0 1 auto;\n    border-radius: 25px;\n    background-color: #f3f3f3;\n    max-width: 70%;\n    padding: 10px 15px;\n\n    animation: vibrate 0.5s linear both;\n}\n\n@keyframes vibrate {\n    0% {\n        -webkit-transform: translate(0);\n                transform: translate(0);\n    }\n    20% {\n        -webkit-transform: translate(-2px, 2px);\n                transform: translate(-2px, 2px);\n    }\n    40% {\n        -webkit-transform: translate(-2px, -2px);\n                transform: translate(-2px, -2px);\n    }\n    60% {\n        -webkit-transform: translate(2px, 2px);\n                transform: translate(2px, 2px);\n    }\n    80% {\n        -webkit-transform: translate(2px, -2px);\n                transform: translate(2px, -2px);\n    }\n    100% {\n        -webkit-transform: translate(0);\n                transform: translate(0);\n    }\n}\n\n.status-image {\n    margin-left: 8px;\n    margin-right: 8px;\n    max-width: 16px;\n    max-height: 16px;\n}\n\n.status-message {\n    font-size: 1.4rem;\n    color: #737373;\n    white-space: pre-wrap;\n    word-break: break-all;\n    word-wrap: break-word;\n}\n",""]),t.exports=e},function(t,e,n){var i=n(72);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(e=n(0)(!1)).push([t.i,"\nhr {\n    border-top: 1px solid #eee;\n    padding: 0;\n    margin: 10px 0;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},r=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),c=n(6),l=n(17),h=n(2),u=n(74),p=n(75),d=n(3),g=n(13),f=n(16),m=n(11),_=n(76),v=n(77),b=n(79),y=function(){function t(t,e,n){var i=this;this._fetchAuthToken=e,this._speechService=n,this._uploadRequest=[],this._requestId=0,this._logger=new d.Logger("ChatServerService"),this._isFirstRun=!0,this.onMessage=function(t,e){},this.onStatusChange=function(t){},this.onSuggestions=function(t){},this._config=this._mergeSettings(p.defaultSettings,t),this._configureLocale(),d.Logger.logLevel=this._config.isDebugMode?d.Logger.LOG_LEVEL.DEBUG:d.Logger.LOG_LEVEL.ERROR,d.Logger.appName=this._config.name,d.Logger.appVersion=this._config.version,window.addEventListener("online",(function(){return i.openConnection()})),window.addEventListener("offline",(function(){return i.closeConnection()})),e&&(this._authTokenService=v.AuthTokenService.getInstance(e))}return t.prototype.connect=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return this._config.clientAuthEnabled?[4,this._authTokenService.getToken()]:[3,2];case 1:t=e.sent();try{this._configureParams(t)}catch(t){return[2,Promise.reject(t.message)]}return this._url=this._setupWebSocketURI(),[2,this._open()];case 2:try{this._configureParams()}catch(t){return[2,Promise.reject(t.message)]}return this._url=this._setupWebSocketURI(),[2,this._open()]}}))}))},t.prototype.uploadAttachment=function(t,e,n,i){var o=this;return new Promise((function(s,r){if(o._config.enableAttachment){o._logger.debug("upload attachment to chat server",t);var a=new FormData;a.append("attachment",t);var h=new XMLHttpRequest,u=o._requestId++;o._uploadRequest.push({id:u,request:h}),h.onreadystatechange=function(){if(h.readyState===XMLHttpRequest.DONE)switch(h.status){case l.Response.STATUS.OK:var a=JSON.parse(h.responseText),p={attachment:{type:o._getAttachmentType(a.type.split("/")[0].toLowerCase()),url:a.url},type:m.PAYLOAD_TYPE.ATTACHMENT},d=g.createUserMessage(p,o._config.userId,new Date,!0);o.send(d,n,a.fileName),s(a);break;case c.Constants.FILE_SIZE_LIMIT_EXCEEDED:e&&e(t.name,h.status,n),o._logger.error("Can't upload attachment.",t,h.status),r("Can not upload attachment, file size should not be more than 25MB.");break;case c.Constants.UNSUPPORTED_FILE_TYPE:e&&e(t.name,h.status,n),o._logger.error("Can't upload attachment.",t,h.status),r("Can not upload attachment, unsupported file type.");break;default:i?o._retryUploadingFile(t,e,n).then((function(t){s(t)})).catch((function(t){r(t)})):(e&&e(t.name,h.status,n),o._logger.error("Can't upload attachment.",t),r("Can not upload attachment."))}o._uploadRequest=o._uploadRequest.filter((function(t){return t.id!==u}))},o.isConnectionOpen()?o._config.clientAuthEnabled?o._authTokenService.getToken().then((function(e){o._configureParams(e),o._pushUpload(h,t,a,e)}),(function(t){o._logger.error("Can not upload attachment, could not get token",t),r("Can not upload attachment, could not get valid token.")})):o._pushUpload(h,t,a):r("Can not upload attachment, not connected to server.")}else r("Can not upload attachment, feature not enabled.")}))},t.prototype.cancelUploadAttachments=function(){this._uploadRequest.forEach((function(t){t.request.abort()}))},t.prototype.getSuggestions=function(t){if(this._logger.debug("Get suggestions from chat server",t),this._ws.readyState===a.CONNECTION_STATE.OPEN){if(this._ws.send(t),t.profile)return}else this._logger.error("Can't get suggestions for the user query, WebSocket status - "+c.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t)},t.prototype.isURLReachable=function(t){this._logger.debug("Check for the reachability of ",t);var e=new XMLHttpRequest;try{return e.open("HEAD",t,!1),e.send(),e.status===l.Response.STATUS.OK}catch(e){return this._logger.error("URL is not reachable: "+t),!1}},t.prototype.getMessages=function(){return window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[]},t.prototype.loadChat=function(){var t=this.getMessages();return t.forEach((function(t){t.isRead=!0})),window.localStorage.setItem(this._localStorageName,JSON.stringify(t)),t},t.prototype.getUnreadMessagesCount=function(){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];for(var e=0,n=0,i=t.messages;n<i.length;n++){var o=i[n];o.from&&!o.isRead&&e++}return e},t.prototype.send=function(t,e,n,i){var o=!1;if(this._wsSend(t)){if(o=!0,t.profile)return o;if(t.messagePayload&&t.messagePayload.type===m.PAYLOAD_TYPE.POSTBACK){var s=g.createUserMessage({text:t.messagePayload.text,type:m.PAYLOAD_TYPE.TEXT},this._config.userId,new Date,!0);s.userId=this._config.userId,this._saveMessage(s),i&&i.hidden||this.onMessage(s)}else n&&(t.messagePayload.attachment.fileName=n),this._saveMessage(t),i&&i.hidden||this.onMessage(t,e)}else this._logger.error("Can't send message");return o},t.prototype.markAsRead=function(e){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];for(var n=0,i=0,o=t.messages;i<o.length;i++){var s=o[i];if(new Date(s.date).getTime()===new Date(e).getTime()){s.isRead=!0,t.messages[n]=s;break}n++}window.localStorage.setItem(this._localStorageName,JSON.stringify(t.messages))},t.prototype.markAllAsRead=function(){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];for(var e=0,n=0,i=t.messages;n<i.length;n++){var o=i[n];o.isRead=!0,t.messages[e]=o,e++}window.localStorage.setItem(this._localStorageName,JSON.stringify(t.messages))},t.prototype.retryMessage=function(t){var e=t.messagePayload;if(this._latestUserMessage)this._latestUserMessage.date=new Date,this.send(this._latestUserMessage);else if(e&&e.postback.text){var n={text:e.postback.text,type:m.PAYLOAD_TYPE.TEXT},i=g.createUserMessage(n,this._config.userId,new Date,!0);this.send(i)}},t.prototype.getChatConfiguration=function(){return this._config},t.prototype.setSettingsProperty=function(t,e){this._config[t]=e},t.prototype.isConnectionOpen=function(){return this._ws&&this._ws.readyState===a.CONNECTION_STATE.OPEN},t.prototype.openConnection=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return this.isConnectionOpen()&&this.closeConnection(),[2,this.connect()]}))}))},t.prototype.closeConnection=function(t,e){this.isConnectionOpen()&&this._ws.close(t,e)},t.prototype.updateUser=function(t,e){this.send(t,null,null,e)},t.prototype._configureParams=function(t){if(this._config.clientAuthEnabled?(this._config.channelId=t.getClaim("channelId"),this._config.userId=t.getClaim("userId")):this._config.userId=this._config.userId||this._generateUserId(),this._searchParams={channelId:this._config.channelId,userId:this._config.userId},!this._config.URI)throw new Error("URI not provided.");if(!this._config.channelId)throw new Error("channelId not provided.");if(!this._config.userId)throw new Error("userId not provided.");this._localStorageName=this._config.name+"-"+this._config.userId+"-messages"},t.prototype._open=function(){var t=this;return new Promise((function(e,n){t._ws||(t._ws=new b.ReconnectingWebSocket(t._url.toString(),t._config.clientAuthEnabled?t._authTokenService:void 0,t._config.reconnectInterval,t._config.reconnectMaxAttempts,t._config.reconnectTimeout,t._config.enableLongPolling,t._config.upgradeToWebSocketInterval,t._setupLongPollingURI().toString()),t._ws.onopen=function(){var n,i;if(t._logger.debug("Connection established"),t._config.enableSpeech){var o={channelId:t._config.channelId,host:t._config.URI,locale:t._config.speechLocale,protocol:t._config.enableSecureConnection?"wss://":"ws:/",userId:t._config.userId};t._config.clientAuthEnabled?t._authTokenService.getToken().then((function(e){t._configureParams(e),t._speechService.init(o,t._authTokenService)})):t._speechService.init(o)}if(t._isFirstRun&&(t._isFirstRun=!1,e(),t._config.initUserProfile&&t._ws.send(t._config.initUserProfile),t._config.initUserHiddenMessage)){var s=void 0;"string"==typeof t._config.initUserHiddenMessage?s={text:t._config.initUserHiddenMessage,type:m.PAYLOAD_TYPE.TEXT}:(null===(n=t._config.initUserHiddenMessage)||void 0===n?void 0:n.type)!==m.PAYLOAD_TYPE.TEXT&&(null===(i=t._config.initUserHiddenMessage)||void 0===i?void 0:i.type)!==m.PAYLOAD_TYPE.LOCATION||(s=t._config.initUserHiddenMessage),t._wsSend(g.createUserMessage(s,t._config.userId,new Date,!0))}},t._ws.onmessage=t._wsMessage.bind(t),t._ws.onclose=function(e){var i;if(t._logger.debug("Connection closed"),t._isFirstRun){t._isFirstRun=!1;var o=(null===(i=e)||void 0===i?void 0:i.reason)?e.reason:"Connection to chat server could not be established. Closing the connection.";n(o)}},t._ws.onstatuschange=function(e){t.onStatusChange(e)}),t._ws.open()}))},t.prototype._pushUpload=function(t,e,n,i){var o=this._setupAttachmentURI();t.open("POST",o.toString()),t.setRequestHeader(c.Constants.FILE_SIZE_METADATA_HEADER,e.size.toString()),this._config.clientAuthEnabled&&t.setRequestHeader("Authorization","Bearer "+i.token),t.send(n)},t.prototype._retryUploadingFile=function(t,e,n){return this.uploadAttachment(t,e,n)},t.prototype._getAttachmentType=function(t){switch(t){case f.ATTACHMENT_TYPE.IMAGE:case f.ATTACHMENT_TYPE.VIDEO:case f.ATTACHMENT_TYPE.AUDIO:return t;default:return f.ATTACHMENT_TYPE.FILE}},t.prototype._generateUserId=function(){var t=new Date;return"user"+1e4*(Math.random()+Date.parse(t.toDateString())+t.getTime())%1e8},t.prototype._setupLongPollingURI=function(){var t=this._config.enableSecureConnection?"https://":"http://",e=new URL(t+this._config.URI+"/chat/v1/chats/message");return h.utils.setSearchParams(e,this._searchParams)},t.prototype._setupWebSocketURI=function(){var t=this._config.enableSecureConnection?"wss://":"ws://",e=new URL(t+this._config.URI+"/chat/v1/chats/sockets/websdk");return h.utils.setSearchParams(e,this._searchParams)},t.prototype._setupAttachmentURI=function(){var t=this._config.enableSecureConnection?"https://":"http://",e=new URL(t+this._config.URI+"/chat/v1/attachments");return h.utils.setSearchParams(e,this._searchParams)},t.prototype._wsSend=function(t){this._logger.debug("Message to chat server",t.messagePayload);var e=!1;if(this._config.delegate&&(this._config.delegate.beforeSend&&h.utils.isFunction(this._config.delegate.beforeSend)&&t.messagePayload&&t.messagePayload.type===m.PAYLOAD_TYPE.TEXT?t.messagePayload=this._config.delegate.beforeSend(t.messagePayload):this._config.delegate.beforePostbackSend&&h.utils.isFunction(this._config.delegate.beforePostbackSend)&&t.messagePayload&&t.messagePayload.type===m.PAYLOAD_TYPE.POSTBACK&&(t.messagePayload=this._config.delegate.beforePostbackSend(t.messagePayload)),!t.messagePayload))return e;this._latestUserMessage=t;t.isRead,t.date,r(t,["isRead","date"]);return this._ws.readyState===a.CONNECTION_STATE.OPEN?e=this._ws.send(t):this._logger.error("Can't send message, WebSocket status - "+c.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t),e},t.prototype._wsMessage=function(t){var e,n,i,o;this._logger.info("Message received: ",t);try{var s=JSON.parse(t);if(s.suggestions?o=!0:(o=!1,i=s.type),!o&&(null===(e=this._config.delegate)||void 0===e?void 0:e.beforeDisplay)&&h.utils.isFunction(this._config.delegate.beforeDisplay)&&(s.messagePayload=this._config.delegate.beforeDisplay(s.messagePayload),!s.messagePayload))return;n=s}catch(e){(n={date:new Date,isRead:!1}).text=t,i="error"}if(o)this.onSuggestions(n);else{if(n.from={type:_.SENDER_TYPE.BOT},n&&(n.text||n.choices)){var r=g.createBotMessage(n.from,{actions:[],text:n.text,type:m.PAYLOAD_TYPE.TEXT},new Date,!1);if("error"===i){var a=this._config.i18n[this._config.locale?this._config.locale:"en"].retryMessage;r.messagePayload.actions.push({actionId:"Retry",label:a,postback:this._latestUserMessage.messagePayload,text:a,type:"postback"})}if(n.choices)for(var c=0,l=n.choices;c<l.length;c++){var u=l[c];r.messagePayload.actions.push({label:u,postback:u,type:"postback"})}n=r}else n.from&&n.to&&delete n.from;n.date=new Date,n.isRead=!1,this._config.enableNotification&&new Audio(this._config.notificationAudioURL).play(),this._saveMessage(n),this.onMessage(n)}},t.prototype._saveMessage=function(e){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[],t.messages.length>=this._config.messageCacheSizeLimit?(t.messages=t.messages.slice(1,this._config.messageCacheSizeLimit),t.messages.push(e)):t.messages.push(e),window.localStorage.setItem(this._localStorageName,JSON.stringify(t.messages))},t.prototype._mergeSettings=function(t,e){var n=i(i({},t),e);if(e.i18n&&Object.keys(e.i18n).length){t.i18n=this._convertKeysToLowerCase(t.i18n),e.i18n=this._convertKeysToLowerCase(e.i18n);var o=new Set;Object.keys(t.i18n).forEach((function(t){o.add(t)})),Object.keys(e.i18n).forEach((function(t){o.add(t)})),n.i18n={},o.forEach((function(o){n.i18n[o]=i(i(i({},t.i18n.en),t.i18n[o]),e.i18n[o])}))}return n.colors=i(i({},t.colors),e.colors),n},t.prototype._convertKeysToLowerCase=function(t){for(var e={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];e[o.toLowerCase()]=t[o]}return e},t.prototype._configureLocale=function(){var t=[];this._config.locale&&t.push(this._config.locale.toLowerCase()),(t=t.concat(u.webApi.getLocales())).indexOf("en")<0&&t.push("en");for(var e=0,n=t;e<n.length;e++){var i=n[e];if(this._isLocaleTranslationExactMatch(i,this._config.i18n)){this._config.locale=i;break}if(this._isLocaleTranslationCloseMatch(i,this._config.i18n)){this._config.locale=i.split("-")[0];break}}},t.prototype._isLocaleTranslationExactMatch=function(t,e){for(var n in t=t.toLowerCase(),e)if(t===n.toLowerCase())return!0;return!1},t.prototype._isLocaleTranslationCloseMatch=function(t,e){for(var n in t=t.toLowerCase().split("-")[0],e)if(t===n.toLowerCase())return!0;return!1},t}();e.ChatServerService=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.webApi={getBrowserLocale:function(){return navigator.language},getLocales:function(){var t;return(null===(t=navigator.languages)||void 0===t?void 0:t.map((function(t){return t.toLowerCase()})))||[]},isLocalStorageAvailable:function(){return i("localStorage")},isLocationServiceAvailable:function(){return"geolocation"in navigator}};var i=function(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultSettings={audioIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%2341bfec%22%20d%3D%22M6%202c-1.1%200-1.99.9-1.99%202L4%2020c0%201.1.89%202%201.99%202H18c1.1%200%202-.9%202-2V8l-6-6H6zm7%207V3.5L18.5%209H13z%22%2F%3E%3C%2Fsvg%3E",badgePosition:{right:"0",top:"0"},botButtonIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%220%200%2048%2048%22%3E%3Cpath%20d%3D%22M0%2024a24%2024%200%201%200%2048%200%2024%2024%200%201%200-48%200%22%20fill%3D%22%231b8fd2%22%20opacity%3D%22.8%22%2F%3E%3Cpath%20d%3D%22M32.25%2031.084h-7.532L19.2%2037.021a1.061%201.061%200%200%201-1.251-1.316l.031-4.622h-1.23C12.47%2031.084%209%2028.372%209%2023.97A7.862%207.862%200%200%201%2016.75%2016h15.5A7.862%207.862%200%200%201%2040%2023.97c0%204.402-3.47%207.114-7.75%207.114zM16.531%2020.938a2.594%202.594%200%201%200%202.594%202.594%202.594%202.594%200%200%200-2.594-2.594zm7.969-.031a2.594%202.594%200%201%200%202.594%202.593%202.594%202.594%200%200%200-2.594-2.594zm7.969.031a2.594%202.594%200%201%200%202.594%202.594%202.594%202.594%200%200%200-2.594-2.594z%22%20fill%3D%22%23fff%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E",chatBubbleIconHeight:"42px",chatBubbleIconWidth:"56px",clientAuthEnabled:!1,colors:{botMessageBackground:"#e5f1ff",branding:"#1b8fd2",text:"#212121",textLight:"#737373",userMessageBackground:"#ececec"},conversationBeginPosition:"top",delaySuggestionsFetch:300,disablePastActions:"all",displayActionsAsPills:!1,embedded:!1,embeddedVideo:!0,enableAttachment:!0,enableAutocomplete:!1,enableAutocompleteClientCache:!1,enableBotAudioResponse:!1,enableClearMessage:!1,enableHeadless:!1,enableLocalConversationHistory:!1,enableLongPolling:!1,enableNotification:!1,enableSecureConnection:!0,enableSpeech:!1,enableSpeechAutoSend:!0,enableTimestamp:!0,errorIcon:"data:image/svg+xml,%3Csvg%20id%3D%22Layer_1%22%20data-name%3D%22Layer%201%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%3E%3Ctitle%3Estat_error_16%3C%2Ftitle%3E%3Ccircle%20cx%3D%228%22%20cy%3D%228%22%20r%3D%228%22%20fill%3D%22%23e4001e%22%2F%3E%3Cpath%20d%3D%22M11.686%2C5.817a1.063%2C1.063%2C0%2C0%2C0-1.5-1.5L8%2C6.5%2C5.818%2C4.314a1.063%2C1.063%2C0%2C0%2C0-1.5%2C1.5L6.5%2C8%2C4.314%2C10.183a1.063%2C1.063%2C0%2C0%2C0%2C1.5%2C1.5L8%2C9.5l2.183%2C2.183a1.063%2C1.063%2C0%2C0%2C0%2C1.5-1.5L9.5%2C8Z%22%20fill%3D%22%23fff%22%2F%3E%3C%2Fsvg%3E",fileIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%2341bfec%22%20d%3D%22M6%202c-1.1%200-1.99.9-1.99%202L4%2020c0%201.1.89%202%201.99%202H18c1.1%200%202-.9%202-2V8l-6-6H6zm7%207V3.5L18.5%209H13z%22%2F%3E%3C%2Fsvg%3E",font:'16px "Helvetica Neue", Helvetica, Arial, sans-serif',height:"620px",i18n:{en:{audioResponseOff:"Audio response off",audioResponseOn:"Audio response on",card:"Card",cardImagePlaceholder:"Loading image",chatTitle:"Ask",clear:"Clear",close:"Close",closing:"Closing",connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",inputPlaceholder:"Type a message",noSpeechTimeout:"Could not detect the voice, no message sent.",previousChats:"Previous conversations",requestLocation:"Requesting location",requestLocationString:"Cannot access your location. Please allow access to proceed further.",retryMessage:"Try again",send:"Send",speak:"Speak",upload:"Upload Document",uploadFailed:"Upload Failed.",uploadFileSizeLimitExceeded:"Upload Failed. File size should not be more than 25MB.",uploadUnsupportedFileType:"Upload Failed. Unsupported file type.",utteranceGeneric:"Message from skill."}},imageIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%2341bfec%22%20d%3D%22M6%202c-1.1%200-1.99.9-1.99%202L4%2020c0%201.1.89%202%201.99%202H18c1.1%200%202-.9%202-2V8l-6-6H6zm7%207V3.5L18.5%209H13z%22%2F%3E%3C%2Fsvg%3E",initBotAudioMuted:!0,isDebugMode:!1,locale:"en",logoIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22%23fff%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M18%2C16.99H11.733L8%2C21.125a1.119%2C1.119%2C0%2C0%2C1-1.021-1.36V16.99H6a5.849%2C5.849%2C0%2C0%2C1-6-5.87A6.061%2C6.061%2C0%2C0%2C1%2C6%2C5H18a6.061%2C6.061%2C0%2C0%2C1%2C6%2C6.12A5.849%2C5.849%2C0%2C0%2C1%2C18%2C16.99ZM6%2C9a2%2C2%2C0%2C1%2C0%2C2%2C2A2%2C2%2C0%2C0%2C0%2C6%2C9Zm6%2C0a2%2C2%2C0%2C1%2C0%2C2%2C2A2%2C2%2C0%2C0%2C0%2C12%2C9Zm6%2C0a2%2C2%2C0%2C1%2C0%2C2%2C2A2%2C2%2C0%2C0%2C0%2C18%2C9Z%22%2F%3E%3C%2Fsvg%3E",maxAttachmentFileSize:25,messageCacheSizeLimit:2e3,messagePadding:"15px",name:"oda-chat",numberOfSuggestions:3,numberOfSuggestionsFromServer:30,openChatOnLoad:!1,openLinksInNewWindow:!1,readMark:"&#x2713;",reconnectInterval:5,reconnectMaxAttempts:50,reconnectTimeout:300,showConnectionStatus:!1,showPrevConvStatus:!0,showTypingIndicator:!0,supportedFileTypes:".aac, .3g2, .3gp, .7z, .amr, .avi, .csv, .doc, .docx, .eml, .gif, .ics, .jfif, .jpeg, .jpg, .key, .log, .m4a, .m4v, .mov, .mp3, .mp4, .mp4a, .mpeg, .mpg, .mpga, .neon, .numbers, .odt, .oga, .ogg, .ogv, .pages, .pdf, .png, .pps, .ppsx, .ppt, .pptx, .qt, .svg, .tif, .tiff, .txt, .vcf, .wav, .webm, .webp, .wmv, .xls, .xlsx, .xml, .yml, .yaml",typingIndicatorTimeout:20,upgradeToWebSocketInterval:300,version:"20.3.1",videoIcon:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%2341bfec%22%20d%3D%22M6%202c-1.1%200-1.99.9-1.99%202L4%2020c0%201.1.89%202%201.99%202H18c1.1%200%202-.9%202-2V8l-6-6H6zm7%207V3.5L18.5%209H13z%22%2F%3E%3C%2Fsvg%3E",width:"375px"}},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.BOT="bot",t.USER="user"}(i||(i={})),e.SENDER_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(78),o=function(){function t(t){this._mFetchToken=t}return t.getInstance=function(e){return t._service||(t._service=new t(e)),t._service},t.prototype.getToken=function(){var t=this;return new Promise((function(e,n){if(t._mFetchToken)if(t._currentAuthToken&&!t._isTokenExpired())e(t._currentAuthToken);else{var o=t._mFetchToken();null===o||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then?n({message:"Please provide a function that can return a Promise resolving to a token."}):o.then((function(o){t._currentAuthToken=new i.JwtToken(o),t._isValidToken()?e(t._currentAuthToken):n({message:"Token doesn't contain all mandatory claims."})}),(function(t){return n(t)}))}else n({message:"No function has been provided to fetch newly generated auth token. Please create a function that returns a Promise to generate new JWT token when called."})}))},t.prototype._isTokenExpired=function(){var t=Math.floor(Date.now()/1e3)+20;return this._currentAuthToken.getClaim("exp")<t},t.prototype._isValidToken=function(){return this._currentAuthToken.getClaim("channelId")&&this._currentAuthToken.getClaim("userId")},t}();e.AuthTokenService=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this._token=t;var e=this._token.split(".");this._header=JSON.parse(atob(e[0])),this._payload=JSON.parse(atob(e[1]))}return Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this._header},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),t.prototype.getClaim=function(t){return this.payload[t]},t}();e.JwtToken=i},function(t,e,n){"use strict";var i=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),s=n(6),r=n(17),a=n(2),c=n(3),l=n(80),h=n(81),u=function(){function t(t,e,n,i,o,s,r,l,h){this._url=t,this._authTokenService=e,this._reconnectInterval=n,this._reconnectMaxAttempts=i,this._reconnectTimeout=o,this._configLongPolling=s,this._upgradeToWebSocketInterval=r,this._pollingUrl=l,this._protocols=h,this._forcedClose=!1,this._onlyTokenSent=!1,this._reconnectAttempt=0,this._isLongPollingEnabled=!1,this._webSocketUpgradeInterval=300,this._logger=new c.Logger("ReconnectingWebSocket"),this.onclose=function(t){},this.onerror=function(t){},this.onmessage=function(t){},this.onopen=function(t){},this.onconnecting=function(){},this.onstatuschange=function(t){},this._logger.debug("WebSocket creation",this._url,"reconnectInterval: "+this._reconnectInterval,"reconnectMaxAttempts: "+this._reconnectMaxAttempts,"reconnectTimeout: "+this._reconnectTimeout),this._configLongPolling&&(this._reconnectInterval=2,this._reconnectMaxAttempts=5),this._reconnectInterval=a.utils.secToMillisec(n),this._reconnectTimeout=a.utils.secToMillisec(o),this._webSocketUpgradeInterval=a.utils.secToMillisec(this._upgradeToWebSocketInterval)}return Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws.protocol},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){return this._ws.bufferedAmount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws.extensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._readyState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return o.CONNECTION_STATE.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return o.CONNECTION_STATE.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return o.CONNECTION_STATE.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return o.CONNECTION_STATE.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws.binaryType},set:function(t){this._ws.binaryType=t},enumerable:!0,configurable:!0}),t.prototype.open=function(){navigator.onLine?this._connect():this._setReadyState(o.CONNECTION_STATE.CLOSED)},t.prototype.close=function(t,e){var n;this._forcedClose=!0,(null===(n=this._ws)||void 0===n?void 0:n.readyState)!==o.CONNECTION_STATE.CLOSED?this._ws.close(t,e):this._isLongPollingEnabled&&(this._isLongPollingEnabled=!1,clearInterval(this._upgradeWebSocketTimer)),this._setReadyState(o.CONNECTION_STATE.CLOSED)},t.prototype.send=function(t){t.isRead,t.date;var e,n=i(t,["isRead","date"]),s=!1;if((null===(e=this._ws)||void 0===e?void 0:e.readyState)===o.CONNECTION_STATE.OPEN){this._onlyTokenSent=!1;try{this._ws.send(JSON.stringify(n)),s=!0}catch(t){s=!1}}else this._isLongPollingEnabled?s=this._longPollSendMessage(n):this._logger.error("Connection closed, can not send message.");return s},t.prototype.addEventListener=function(t,e,n){this._ws&&this._ws.addEventListener(t,e,n)},t.prototype.dispatchEvent=function(t){return!!this._ws&&this._ws.dispatchEvent(t)},t.prototype.removeEventListener=function(t,e,n){this._ws&&this._ws.removeEventListener(t,e,n)},t.prototype._connect=function(){var t,e,n=this;if(window.WebSocket){if(this._logger.debug("Initiating connection to server",this._url),this._isLongPollingEnabled||this._setReadyState(o.CONNECTION_STATE.CONNECTING),!this._ws||this._ws.readyState===o.CONNECTION_STATE.CLOSED){this._ws=new WebSocket(this._url,this._protocols),this._ws.onmessage=function(t){n._logger.debug("WebSocket onmessage",n._url,t.data);try{var e=JSON.parse(t.data);if(h.isPongMessage(e))return;n.onmessage(t.data)}catch(e){console.error("Error in parsing message ",t.data)}},this._ws.onerror=function(t){n._logger.debug("WebSocket onerror",n._url,t),n.onerror(t)};var i=function(i){e=n._startPingPong(),clearTimeout(t),clearInterval(n._upgradeWebSocketTimer),t=null,n._reconnectAttempt=0,n._setReadyState(o.CONNECTION_STATE.OPEN),n._isLongPollingEnabled=!1,n._forcedClose=!1,n.onopen(i)};this._ws.onopen=function(t){n._logger.debug("WebSocket opened",n._url),n._authTokenService?(n._onlyTokenSent=!0,n._authTokenService.getToken().then((function(e){n._ws.send(JSON.stringify(h.buildAuthTokenMessage(l.TOKEN_TYPE.JWT,e.token))),setTimeout((function(){return n._onlyTokenSent=!1}),2e4),i(t)}))):i(t)},this._ws.onclose=function(t){clearInterval(e),n._forcedClose?n.onclose(t):n._authTokenService&&n._onlyTokenSent&&t.code!==s.Constants.WEBSOCKET_CLOSE_EVENT.CODE.ABNORMAL_CLOSURE?(n._logger.error("Token authentication failed, connection closed."),n.onclose(t)):setTimeout((function(){n._reconnectAttempt>=n._reconnectMaxAttempts?n._configLongPolling?n._longPollInit():(n._logger.debug("Reconnection attempts limit reached"),n._setReadyState(o.CONNECTION_STATE.CLOSED),n.onclose(t)):n._ws&&n._ws.readyState===o.CONNECTION_STATE.CLOSED&&(n._reconnectAttempt++,n._logger.debug("Reconnection attempt",n._reconnectAttempt),n._connect())}),n._reconnectInterval)}}}else this._configLongPolling?this._longPollInit():(this.onclose(new CloseEvent("WebSocket unavailable",{code:3e3,reason:"WebSocket is disabled or unavailable on this client. Can not connect to chat server."})),this._setReadyState(o.CONNECTION_STATE.CLOSED))},t.prototype._longPollInit=function(){var t=this;this._isLongPollingEnabled||(this._setReadyState(o.CONNECTION_STATE.CONNECTING),this._longPollConnect().then((function(){t.onopen(null),t._isLongPollingEnabled=!0,t._setReadyState(o.CONNECTION_STATE.OPEN),t._upgradeWebSocketTimer=t._startUpgradeToWebSocketTimer(),t._longPollServerPolling()})).catch((function(){t._isLongPollingEnabled=!1,t._setReadyState(o.CONNECTION_STATE.CLOSED),t.onclose(null)})))},t.prototype._longPollConnect=function(){var t=this;return new Promise((function(e,n){var i=new XMLHttpRequest;i.open("POST",t._pollingUrl),i.setRequestHeader("Content-Type","application/json"),i.onload=function(){var t,o;(null===(t=i)||void 0===t?void 0:t.status)>=200&&(null===(o=i)||void 0===o?void 0:o.status)<300?e():n()},t._authTokenService?t._authTokenService.getToken().then((function(t){i.setRequestHeader("Authorization","Bearer "+t.token),i.send(JSON.stringify(h.buildPingMessage()))})).catch((function(){t._logger.error("Can not connect to server, token invalid."),n()})):i.send(JSON.stringify(h.buildPingMessage()))}))},t.prototype._longPollServerPolling=function(){var t=this;if(this._isLongPollingEnabled){var e=new XMLHttpRequest;e.open("GET",this._pollingUrl),e.onload=function(){e.status&&e.status===r.Response.STATUS.OK&&t._longPollOnMessage(e.responseText),t._longPollServerPolling()},this._authTokenService?this._authTokenService.getToken().then((function(t){e.setRequestHeader("Authorization","Bearer "+t.token),e.send()})).catch((function(e){t._logger.error("Can not connect to server, token invalid.")})):e.send()}else this._ws||(this.onclose(null),this._setReadyState(o.CONNECTION_STATE.CLOSED))},t.prototype._longPollSendMessage=function(t){var e=this,n=new XMLHttpRequest;return n.open("POST",this._pollingUrl),n.setRequestHeader("Content-Type","application/json"),this._authTokenService?this._authTokenService.getToken().then((function(e){n.setRequestHeader("Authorization","Bearer "+e.token),n.send(JSON.stringify(t))})).catch((function(t){e._logger.error("Can not send message, token invalid.")})):n.send(JSON.stringify(t)),!0},t.prototype._longPollOnMessage=function(t){var e=this;try{JSON.parse(t).forEach((function(t){e.onmessage(t)}))}catch(e){this._logger.error("Unable to parse response",t)}},t.prototype._setReadyState=function(t){this._readyState=t,this.onstatuschange(t)},t.prototype._startPingPong=function(){var t=this;return window.setInterval((function(){var e;(null===(e=t._ws)||void 0===e?void 0:e.readyState)===o.CONNECTION_STATE.OPEN&&t._ws.send(JSON.stringify(h.buildPingMessage()))}),h.PING_PONG_INTERVAL)},t.prototype._startUpgradeToWebSocketTimer=function(){var t=this;return window.setInterval((function(){t._reconnectAttempt=0,t._connect()}),this._webSocketUpgradeInterval)},t}();e.ReconnectingWebSocket=u},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.JWT="jwt"}(i||(i={})),e.TOKEN_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(82);e.buildAuthTokenMessage=function(t,e){return{state:{token:e,tokenType:t,type:i.STATE_TYPE.AUTH}}};e.buildPingMessage=function(){return{state:{type:i.STATE_TYPE.PING}}};e.isPongMessage=function(t){return t.state&&t.state.type&&t.state.type===i.STATE_TYPE.PONG};e.PING_PONG_INTERVAL=3e4},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.AUTH="auth",t.PING="ping",t.PONG="pong"}(i||(i={})),e.STATE_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=n(2),s=function(){function t(){this.speechRoute="/voice/stream/recognize",this.speechLocale="en-us",this.speechDomain="generic",this.started=!1,this.BUFF_SIZE=4096,this.microphoneStreamBuffer=[],this.isFirstFrame=!0,this.filterBuffer=[],this.LP_48000_TO_16000_FIR=[-25033838264794034e-21,-3645156113737857e-20,-11489993827892933e-21,393243788874656e-19,6998419352067277e-20,37556691270439976e-21,-476966455345305e-19,-.00011379935461751734,-8400957697117619e-20,4208817777607469e-20,.00016391587447478332,.00015508372993570357,-1253765788919669e-20,-.00021258262011091092,-.0002524059896175195,-51874329668708116e-21,.0002479230009768214,.00037351534477673157,.00016157590781788105,-.0002541085239198603,-.000510486865332593,-.0003246104617540939,.00021219136947965464,.0006488877825604561,.0005444416935293036,-.0001016639071691704,-.0007673001147209819,-.0008176720912938691,-972696982411551e-19,.0008376185852528038,.0011319450250252222,.0004008193339799052,-.0008262743020160207,-.0014643282305934196,-.0008183365045047033,.0006964471772153777,.001780467922489105,.0013489288090360295,-.00041122152287042,-.0020347535966250413,-.0019782994815083733,-6247794246099269e-20,.002171643809964705,.0026761621389245617,.00074944268608935,-.00212817775887288,-.003394541347147186,-.0016615884301227524,.001837545335885159,.004067170702246546,.0027936171643976352,-.001233420727213658,-.004610035314537476,-.004119319153202972,.00025459137646049936,.00492286494534436,.005588805700369816,.001150762425755883,-.004891042781491068,-.0071267634777626675,-.003021979039818941,.00438688631315642,.008631467181982988,.005385139236634672,-.003268406079325266,-.009973661255235284,-.008256256502745316,.0013719935383757782,.010993210336541666,.011651337116264694,.0015082475865128093,-.01148872195209017,-.015609515327517686,-.005671504441670989,.011188303272599716,.02024519058502148,.011637590928971467,-.009667754909210324,-.025878090076785515,-.020500381603699786,.006098908137700642,.033428666116203716,.03513487017573178,.001719739622764723,-.046085580848361105,-.06623078150315037,-.023349941728869696,.08292213207159124,.21069217442624302,.2973829711397418,.2973829711397419,.21069217442624305,.08292213207159124,-.023349941728869693,-.06623078150315037,-.046085580848361105,.0017197396227647225,.03513487017573178,.033428666116203716,.006098908137700641,-.020500381603699783,-.025878090076785508,-.009667754909210326,.011637590928971469,.020245190585021472,.011188303272599716,-.00567150444167099,-.015609515327517682,-.01148872195209017,.001508247586512809,.011651337116264699,.010993210336541666,.0013719935383757782,-.008256256502745314,-.009973661255235283,-.0032684060793252657,.00538513923663467,.008631467181982988,.004386886313156419,-.0030219790398189413,-.0071267634777626675,-.0048910427814910715,.0011507624257558842,.005588805700369813,.00492286494534436,.00025459137646049936,-.004119319153202973,-.004610035314537475,-.0012334207272136583,.002793617164397636,.004067170702246546,.0018375453358851592,-.0016615884301227509,-.0033945413471471847,-.0021281777588728797,.0007494426860893505,.0026761621389245612,.0021716438099647056,-6247794246099253e-20,-.001978299481508373,-.0020347535966250404,-.00041122152287042,.0013489288090360292,.0017804679224891048,.0006964471772153777,-.0008183365045047026,-.00146432823059342,-.0008262743020160207,.0004008193339799063,.0011319450250252222,.0008376185852528037,-9726969824115494e-20,-.0008176720912938694,-.0007673001147209783,-.00010166390716916983,.0005444416935293033,.0006488877825604562,.0002121913694796546,-.00032461046175409424,-.000510486865332593,-.00025410852391986036,.0001615759078178811,.0003735153447767315,.00024792300097682137,-5187432966870808e-20,-.0002524059896175194,-.00021258262011091095,-1253765788919669e-20,.0001550837299357036,.0001639158744747833,42088177776074685e-21,-8400957697117623e-20,-.00011379935461751733,-4769664553453051e-20,3755669127044002e-20,699841935206728e-19,393243788874656e-19,-11489993827892933e-21,-3645156113737856e-20,-2503383826479402e-20],this.LP_44100_TO_16000_FIR=[-5044267067893139e-21,5738740247594612e-21,1611195555688156e-20,10560179594562795e-21,-1242816862904201e-20,-3084430704328611e-20,-18160396924882423e-21,2303124169528074e-20,5216612702894834e-20,2806026886746509e-20,-389608521587068e-19,-8174245278012476e-20,-4037543061985353e-20,619375276294956e-19,.00012143092661620545,55083199655424166e-21,-9401891583478883e-20,-.00017326981522755043,-7198069055926206e-20,.0001376274218691789,.00023946132645647525,9064030545698025e-20,-.00019557611633250834,-.0003223511502826996,-.00011036322783022617,.0002710935667931249,.00042440564349633953,.00013013140955365376,-.00036784896615780913,-.0005481886438481025,-.00014855826094166272,.0004899798946967381,.000696340560985472,.00016383778624615643,-.0006421263408051642,-.0008715631880363658,-.00017369118859371453,.000829476349448821,.0010766146787146871,.00017530890385814463,-.0010578310750603923,-.001314320458073489,-.0001652844648711556,.0013337004262191077,.0015876076783199174,.000139534308084411,-.0016644454627712116,-.001899573527380014,-9319422024995832e-20,.002058491185395933,.0022536018141979036,20477911370491685e-21,-.0025256449668619525,-.0026535487754524955,8552498376473957e-20,.0030775744811722015,.0031040297261921,-.00023314744969763122,-.003728529808331677,-.003610856230113392,.000432598472497653,.0044964472481822506,.004181705019767344,-.0006966685466235378,-.005404666489478738,-.00482715710731867,.0010418556659416306,.006484667519607787,.00556235368742558,-.0014902159613265254,-.007780573986407925,-.0064097301786953595,.002072517010858728,.009356870546119134,.0074037416266333166,-.00283386009764953,-.011312323822665827,-.008599512596140524,.003844300507349054,.013806774337071994,.01008985372973804,-.005220460312862638,-.01711716324115331,-.01204196749753927,.007174046245357611,.021768247992024713,.01478690833035584,-.010136389804721707,-.02888735624896028,-.019078400739739057,.015146805312378952,.041410446665863104,.027068163980255515,-.025512027260482153,-.07011218378743589,-.04829678433503421,.06041368701604651,.21199607414538668,.3213532652447261,.3213532652447261,.21199607414538668,.060413687016046526,-.04829678433503422,-.07011218378743589,-.025512027260482153,.027068163980255515,.041410446665863104,.015146805312378952,-.019078400739739057,-.02888735624896028,-.010136389804721703,.01478690833035584,.021768247992024713,.007174046245357611,-.01204196749753927,-.01711716324115331,-.005220460312862639,.010089853729738038,.013806774337071994,.0038443005073490553,-.008599512596140524,-.011312323822665827,-.0028338600976495314,.007403741626633317,.009356870546119134,.002072517010858727,-.006409730178695359,-.007780573986407925,-.001490215961326526,.005562353687425577,.006484667519607787,.0010418556659416256,-.004827157107318673,-.005404666489478739,-.0006966685466235378,.004181705019767345,.004496447248182251,.0004325984724976533,-.003610856230113392,-.003728529808331677,-.0002331474496976315,.0031040297261921003,.003077574481172201,8552498376473897e-20,-.002653548775452496,-.002525644966861952,2047791137049164e-20,.002253601814197904,.002058491185395933,-9319422024995909e-20,-.001899573527380014,-.0016644454627712118,.00013953430808441038,.0015876076783199174,.0013337004262191077,-.0001652844648711556,-.0013143204580734896,-.0010578310750603925,.00017530890385814333,.0010766146787146878,.0008294763494488195,-.00017369118859371463,-.00087156318803637,-.0006421263408051633,.00016383778624615698,.0006963405609854716,.0004899798946967381,-.00014855826094166245,-.0005481886438481027,-.00036784896615780924,.00013013140955365368,.00042440564349633964,.00027109356679312505,-.00011036322783022619,-.0003223511502826996,-.00019557611633250842,9064030545698017e-20,.00023946132645647525,.00013762742186917883,-7198069055926207e-20,-.0001732698152275505,-9401891583478886e-20,5508319965542416e-20,.00012143092661620549,6193752762949557e-20,-4037543061985352e-20,-8174245278012477e-20,-38960852158706805e-21,28060268867465078e-21,52166127028948336e-21,2303124169528077e-20,-18160396924882423e-21,-30844307043286126e-21,-12428168629042018e-21,10560179594562806e-21,1611195555688157e-20,5738740247594605e-21,-5044267067893138e-21],this.setupMediaDevices()}return t.getInstance=function(){return this._service||(this._service=new t),this._service},t.prototype.init=function(t,e){var n=this;return new Promise((function(i,o){n.authTokenService=e,n.buildSpeechRequestUrl(t,!!e).then((function(t){n.requestUrl=t,i()})).catch((function(t){o(t)}))}))},t.prototype.startRecording=function(t,e){return this.onSpeechRecognition=t,this.onSpeechNetworkChange=e,this.microphoneStreamBuffer=[],this.getAudioInput()?this.startRecordingCordova():this.startRecordingWeb()},t.prototype.stopRecording=function(){this.connection&&(this.connection.readyState===i.CONNECTION_STATE.OPEN&&this.connection.close(),this.stopMicrophone())},t.prototype.startRecordingWeb=function(){var t=this;return new Promise((function(e,n){t.requestUrl?navigator.mediaDevices?t.started?n(new Error("A speech recognition is in process. Can not start a new recognition.")):navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){e(),t.audioContext=new AudioContext,t.microphoneStream=t.audioContext.createMediaStreamSource(n),t.startMicrophone()})).catch((function(t){n(t)})):n(new Error("getUserMedia is not implemented in this browser. Can not record voice.")):n(new Error("Speech server URL not set. Can not start recording."))}))},t.prototype.startRecordingCordova=function(){var t=this;return new Promise((function(e,n){t.getMicrophonePermission().then((function(){e(),t.getAudioInput().start({audioSourceType:t.getAudioInput().AUDIOSOURCE_TYPE.VOICE_RECOGNITION||t.getAudioInput().AUDIOSOURCE_TYPE.DEFAULT,streamToWebAudio:!0}),t.audioContext=t.getAudioInput().getAudioContext(),t.microphoneStream=t.getAudioInput(),t.startMicrophone()})).catch((function(t){n(t)}))}))},t.prototype.getMicrophonePermission=function(){var t=this;return new Promise((function(e,n){t.getAudioInput().checkMicrophonePermission((function(i){try{i?e():t.getAudioInput().getMicrophonePermission((function(t,i){try{t?e():n("Permission to record voice has been denied. "+i)}catch(t){n("Start after getting permission exception: "+t)}}))}catch(t){n(t)}}))}))},t.prototype.setupMediaDevices=function(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),navigator.mediaDevices&&void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise((function(n,i){e.call(navigator,t,n,i)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),window.AudioContext=window.AudioContext||window.webkitAudioContext},t.prototype.buildSpeechRequestUrl=function(t,e){var n=this,i=function(){var i=t.locale||n.speechLocale,s=new URL(t.protocol+t.host+n.speechRoute+"/"+i+"/"+n.speechDomain),r={channelId:t.channelId,encoding:"audio/raw",userId:t.userId};return e&&(r.jwtInBody="true"),encodeURI(o.utils.setSearchParams(s,r).toString())};return new Promise((function(o,s){if(e)return n.authTokenService.getToken().then((function(e){t.channelId=e.getClaim("channelId"),t.userId=e.getClaim("userId"),o(i())})).catch((function(){s(Error("Unable to fetch JWT token. Can not use speech service."))})),i();o(i())}))},t.prototype.connectToWebSocket=function(t){var e=new WebSocket(t);return e.onopen=this.connectionOnOpen.bind(this),e.onclose=this.connectionOnClose.bind(this),e.onmessage=this.connectionOnMessage.bind(this),e.onerror=this.connectionOnError.bind(this),e},t.prototype.connectionOnOpen=function(){var t=this;this.authTokenService?this.authTokenService.getToken().then((function(e){t.connectionSendMessage("Bearer "+e.token),setTimeout((function(){t.connection.readyState===i.CONNECTION_STATE.OPEN&&(t.setConnectionStatus(i.CONNECTION_STATE.OPEN),t.dumpVoiceBuffer())}),500)})).catch((function(){t.connection.close()})):(this.setConnectionStatus(i.CONNECTION_STATE.OPEN),this.dumpVoiceBuffer())},t.prototype.connectionOnClose=function(t){this.setConnectionStatus(i.CONNECTION_STATE.CLOSED),this.stopMicrophone()},t.prototype.connectionOnMessage=function(t){try{var e=JSON.parse(t.data);this.onSpeechRecognition(e)}catch(t){console.log(t)}},t.prototype.connectionOnError=function(t){this.connection.readyState===i.CONNECTION_STATE.OPEN&&this.connection.close()},t.prototype.connectionSendMessage=function(t){this.connection.readyState===i.CONNECTION_STATE.OPEN?this.connection.send(t):this.microphoneStreamBuffer.push(t)},t.prototype.setConnectionStatus=function(t){this.onSpeechNetworkChange(t)},t.prototype.dumpVoiceBuffer=function(){for(;this.microphoneStreamBuffer.length>0;)this.connection.send(this.microphoneStreamBuffer.shift())},t.prototype.getAudioInput=function(){return window.audioinput},t.prototype.lanczosWindow=function(t,e){if(0===e)return 1;if(e>=t||e<=-t)return 0;var n=Math.PI*e;return t*Math.sin(n)*Math.sin(n/t)/(n*n)},t.prototype.downsampleBuffer=function(t,e,n){if(n===e)return t;if(n>e)throw new Error("Input sample rate ("+e+" kHz) is lower than output sample rate("+n+" kHz) : Use case not handled.");var i=[];if(48e3===e)i=this.LP_48000_TO_16000_FIR;else{if(44100!==e)throw new Error(e+" kHz is not an expected input sampling frequency");i=this.LP_44100_TO_16000_FIR}var o,s,r,a=e/n;this.isFirstFrame?(o=Math.floor(t.length%a),s=t.length-o,r=0===o?Array.from(t):t.slice(0,s)):(o=Math.floor((t.length+this.filterBuffer.length-i.length)%a),s=t.length+this.filterBuffer.length-i.length-o,(r=new Float32Array(this.filterBuffer.length+s)).set(this.filterBuffer),r.set(t.slice(0,s),this.filterBuffer.length));var c=Math.floor(s/a),l=new Int16Array(c);if(48e3===e)for(var h=i.length;h<r.length;h+=a){for(var u=0,p=0;p<i.length;p++)u+=r[h-p]*i[p];var d=32767*Math.max(Math.min(u,1),-1);l[(h-i.length)/a]=d}else{var g=[];for(h=i.length;h<r.length;h++){for(u=0,p=0;p<i.length;p++)u+=r[h-p]*i[p];g[h-i.length]=u}for(var f=0;f<c;f++){var m=f*a,_=Math.floor(m)-3+1,v=Math.floor(m)+3;for(u=0,h=_;h<=v;h++){u+=(h<0?g[0]:h>=g.length?g[g.length-1]:g[h])*this.lanczosWindow(3,m-h)}l[f]=32767*Math.max(Math.min(u,1),-1)}}return this.isFirstFrame?this.filterBuffer=t.slice(s-i.length-this.filterBuffer.length):this.filterBuffer=t.slice(s-i.length-(this.filterBuffer.length-i.length)),this.isFirstFrame=!1,l.buffer},t.prototype.processAudioBuffer=function(t){var e=t.inputBuffer.getChannelData(0),n=t.inputBuffer.sampleRate,i=this.downsampleBuffer(e,n,16e3);this.connectionSendMessage(i)},t.prototype.stopMicrophone=function(){var t,e,n,o,s,r=this;this.started=!1,this.connection&&(this.connection.readyState===i.CONNECTION_STATE.OPEN&&this.connectionSendMessage("Done"),this.isFirstFrame=!0,this.getAudioInput()?this.getAudioInput().stop():(null===(s=null===(o=null===(e=null===(t=this.microphoneStream)||void 0===t?void 0:t.mediaStream)||void 0===e?void 0:(n=e).getAudioTracks)||void 0===o?void 0:o.call(n))||void 0===s||s.forEach((function(t){t.stop(),r.microphoneStream.mediaStream.removeTrack(t)})),this.audioContext&&this.audioContext.close()),this.processor&&this.processor.disconnect(),this.microphoneStream=null,this.audioContext=null,this.processor=null,this.microphoneStreamBuffer=[])},t.prototype.startMicrophone=function(){this.connection=this.connectToWebSocket(this.requestUrl),this.processor=this.audioContext.createScriptProcessor(this.BUFF_SIZE,1,1),this.processor.onaudioprocess=this.processAudioBuffer.bind(this),this.microphoneStream.connect(this.processor),this.processor.connect(this.audioContext.destination),this.started=!0},t}();e.SpeechRecognitionService=s}]).default}));